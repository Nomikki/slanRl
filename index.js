(()=>{"use strict";var e={260:(e,t,a)=>{a.r(t),a.d(t,{default:()=>i});const i={colderGray:"#8cb2c6",coldGray:"#979ea1",darkBlue:"#1f273c",darkerBlue:"#495c67",darkerGreen:"#080",darkGreen:"#0a0",darkRed:"#a00",darkYellow:"#aa2",fuxian:"#f0f",gray:"#888",grayRed:"#a88",green:"#0a3",lightBlue:"#0cf",lighterLime:"#afa",lighterRed:"#f88",lighterYellow:"#ffa",lightestGray:"#ddd",lightGray:"#aaa",lightLime:"#8f8",lightOrange:"#fca",lightPastelRed:"#fa9",lightPurple:"#9ac",lightRed:"#f44",lightTeal:"#0fa",lightYellow:"#ddc275",lime:"#3f3",navyBlue:"#1a2032",orange:"#fa0",pastelRed:"#faa",red:"red",teal:"#0a9",turqoise:"aqua",white:"#fff",yellow:"#ff0",ui_allowed:"#fff",ui_background:"#1a2032",ui_disallowed:"#f88",ui_door:"#ddc275",ui_game_saved:"#0fa",ui_healed:"#8f8",ui_hp_10_percent:"#f44",ui_hp_25_percent:"#f44",ui_hp_50_percent:"#faa",ui_hp_95_percent:"#aaa",ui_hp_max:"#afa",ui_info:"#979ea1",ui_inventory_full:"red",ui_level_up:"#ff0",ui_map_background:"#1f273c",ui_menu_border:"#aaa",ui_menu_cursor:"#aaa",ui_picked_up:"#aaa",ui_tempImage:"#3f3",ui_text:"#8cb2c6",ui_version:"#495c67",ui_wall_dark:"#495c67",ui_wall:"#8cb2c6",pickup_armor_item:"#9ac",pickup_healthpotion:"#f0f",pickup_nutellabun:"#ddc275",pickup_scroll_of_confusion:"#ffa",pickup_scroll_of_fireball:"#fa0",pickup_scroll_of_lightning:"aqua",pickup_scroll_of_map:"#aa2",pickup_weapon_item:"#3f3",actor_hero:"#fff",actor_stairs:"#fff",monster_bat:"#888",monster_ghoul:"#0a9",monster_giant_rat:"#888",monster_jackal:"#888",monster_kobold:"#a88",monster_lizard:"#0a3",monster_orc:"#0a0",monster_rat:"#888",monster_troll:"#080",log_dead_body:"#a00",log_default_text:"#aaa",log_defeat:"#a00",log_enemy_attack:"#aaa",log_hilight_text:"#fff",log_player_attack:"#ddd",default_item:"#f0f",default_monster:"#f0f"}},850:(e,t,a)=>{a.r(t)},886:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.default=[{name:"leather armor",ac:11,armorType:"light",weight:10},{name:"studded leather",ac:12,armorType:"light",weight:13},{name:"hide",ac:12,armorType:"medium",weight:12},{name:"chain shirt",ac:13,armorType:"medium",weight:20},{name:"scale mail",ac:14,armorType:"medium",weight:45},{name:"breastplate",ac:14,armorType:"medium",weight:20},{name:"half plate",ac:15,armorType:"medium",weight:40},{name:"ringmail",ac:14,armorType:"heavy",weight:40},{name:"chain mail",ac:16,armorType:"heavy",weight:55},{name:"splint",ac:17,armorType:"heavy",weight:60},{name:"plate",ac:18,armorType:"heavy",weight:65},{name:"shield",ac:2,armorType:"shield",weight:6}]},373:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.default=[{name:"bard",flavourText:"Whether poet, scholar, or scroundrel, a bard weaves magic through words and music manipulate minds, and heal wounds. The bard is a master of song, speech and the magic they contain.",healthAtStart:8,healthIncreasePerLevel:5,savingThrows:[{type:"dex"}],proficiencies:[{type:"light armor"},{type:"simple weapon"},{type:"hand crossbow"},{type:"longsword"},{type:"rapier"},{type:"shortsword"}]},{name:"cleric",flavourText:"Clerics are intermediaries between the mortal world and the distant of planes of the gods. As varied as the gods they serve, clerics strive to embody the handiwork of their deities and are imbued with magic.",healthAtStart:8,healthIncreasePerLevel:5,savingThrows:[{type:"wis"}],proficiencies:[{type:"light armor"},{type:"simple weapon"},{type:"medium armor"},{type:"shield"}]},{name:"fighter",flavourText:"Every fighter can pick up a weapon and wield it ably. Likewise, a fighter is adept with shields and every form of armor. Beyond that basic degree of familiarity, each fighter specializes in a certain style of combat. Some concentrate on archery, some on fighting with two weapons at once, and some on augmenting on their martial skills with magic.",healthAtStart:10,healthIncreasePerLevel:6,savingThrows:[{type:"con"},{type:"str"}],proficiencies:[{type:"light armor"},{type:"medium armor"},{type:"heavy armor"},{type:"shield"},{type:"simple weapons"},{type:"martial weapons"}]},{name:"rogue",flavourText:"Rogues rely on skill, stealth, and thei foes' vulnarabilities to get the upper hand in any situation. They have a knack for finding the solution to just about any problem.",healthAtStart:8,healthIncreasePerLevel:5,savingThrows:[{type:"dex"},{type:"int"}],proficiencies:[{type:"light armor"},{type:"simple weapon"},{type:"hand crossbow"},{type:"longsword"},{type:"rapier"},{type:"shortsword"}]},{name:"wizard",flavourText:"Drawing on the subtle weave of magic that permeates the cosmos, wizards casts spells of explosive fire, arcing lightning, subtle deception and brute-force mind control.",healthAtStart:6,healthIncreasePerLevel:4,savingThrows:[{type:"wis"},{type:"int"}],proficiencies:[{type:"dagger"},{type:"dart"},{type:"sling"},{type:"quarterstaff"},{type:"light crossbow"}]}]},391:function(e,t,a){var i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const s=i(a(260));t.default=[{name:"health potion",message:"gulp gulp gulp...",ch:"!",color:s.default.pickup_healthpotion,weight:.1,selector:{type:"none",range:0},effect:{type:"health",amount:4}},{name:"nutella bun",message:"omnomnom...",ch:"@",color:s.default.pickup_nutellabun,weight:.1,selector:{type:"none",range:0},effect:{type:"health",amount:30}},{name:"scroll of fireball",message:"Everything burns",ch:"#",color:s.default.pickup_scroll_of_fireball,weight:.05,selector:{type:"selected range",range:3},effect:{type:"health",amount:-12}},{name:"scroll of confusion",message:"confused af",ch:"#",color:s.default.pickup_scroll_of_confusion,weight:.05,selector:{type:"selected monster",range:5},effect:{type:"change ai",amount:10}},{name:"scroll of map",message:"All is clear!",ch:"#",color:s.default.pickup_scroll_of_map,weight:.05,selector:{type:"none",range:0},effect:{type:"map clear",amount:0}},{name:"scroll of lighting bolt",message:"A lighting bolt strikes!",ch:"#",color:s.default.pickup_scroll_of_lightning,weight:.05,selector:{type:"closest monster",range:5},effect:{type:"health",amount:-20}}]},47:function(e,t,a){var i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const s=i(a(260));t.default=[{name:"bat","size:":"tiny",type:"beast",ch:"b",color:s.default.monster_bat,hp:1,ac:12,xp:5,abilities:{str:2,dex:15,con:8,int:2,wis:12},attacks:[{name:"bite",damage:"1d1",damageType:"piercing"}]},{name:"jackal","size:":"small",type:"beast",ch:"j",color:s.default.monster_jackal,hp:3,ac:12,xp:10,abilities:{str:8,dex:15,con:11,int:3,wis:12},attacks:[{name:"bite",damage:"1d4",damageType:"piercing"}]},{name:"lizard","size:":"tiny",type:"beast",ch:"l",color:s.default.monster_lizard,hp:2,ac:10,xp:10,abilities:{str:2,dex:11,con:10,int:1,wis:8},attacks:[{name:"bite",damage:"1d1",damageType:"piercing"}]},{name:"kobold","size:":"small",type:"humanoid",ch:"k",color:s.default.monster_kobold,hp:5,ac:12,xp:25,abilities:{str:7,dex:15,con:9,int:8,wis:7},attacks:[{name:"dagger",damage:"1d4",damageType:"piercing"},{name:"sling",damage:"1d4",damageType:"bludgeoning"}]},{name:"rat","size:":"tiny",type:"beast",ch:"r",color:s.default.monster_rat,hp:1,ac:10,xp:5,abilities:{str:2,dex:11,con:9,int:2,wis:10},attacks:[{name:"bite",damage:"1d1",damageType:"piercing"}]},{name:"giant rat","size:":"small",type:"beast",ch:"R",color:s.default.monster_giant_rat,hp:7,ac:12,xp:25,abilities:{str:7,dex:15,con:11,int:2,wis:10},attacks:[{name:"bite",damage:"1d4",damageType:"piercing"}]},{name:"ghoul",size:"medium",type:"undead",ch:"G",color:s.default.monster_ghoul,hp:22,ac:12,xp:200,abilities:{str:13,dex:15,con:10,int:7,wis:10},attacks:[{name:"bite",damage:"2d6",damageType:"piercing"},{name:"claws",damage:"2d4",damageType:"slashing"}]},{name:"orc",size:"medium",type:"humanoid",ch:"o",color:s.default.monster_orc,hp:15,ac:13,xp:100,abilities:{str:16,dex:12,con:16,int:7,wis:11},attacks:[{name:"greataxe",damage:"1d12",damageType:"slashing"},{name:"javelin",damage:"1d6",damageType:"piercing"}]},{name:"troll",size:"large",type:"giant",ch:"t",color:s.default.monster_troll,hp:84,ac:15,xp:1800,abilities:{str:18,dex:13,con:20,int:7,wis:9},attacks:[{name:"bite",damage:"1d16",damageType:"piercing"},{name:"claw",damage:"2d6",damageType:"slashing"}]}]},882:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.default=[{name:"dwarf",flavourText:"Kingdoms richs in ancient grandeur, halls carved into the roots of mountains, the echoing of picks and hammers in deep mines and blazing forges, and a commitment to clan and tradition - these common threads unite all dwarves.",toughnessIncrease:1,abilityIncrease:{str:2,dex:0,con:2,int:0,wis:0},resilience:"poison",proficiencies:[{type:"light armor"},{type:"medium armor"}]},{name:"elf",flavourText:"A people of otherworldy grace, elves dwell in places of ethereal beauty, in the midst of ancient forest or in spires glittering with fearie light, where soft music drifts through the air and gentle fragrances waft on the breeze.",toughnessIncrease:0,abilityIncrease:{str:0,dex:2,con:0,int:1,wis:1},resilience:"none",proficiencies:[{type:"longsword"},{type:"shortsword"},{type:"shortbow"},{type:"longbow"}]},{name:"halfling",flavourText:"The diminutive halflings survive in a world full of larger creatures by avoiding notire or, barring that, avoiding offense. Standing about 3 feet tall, they appear relatively harmless and so have managed to survive for centuries in the shadow os empires and on the edges of wars.",toughnessIncrease:0,abilityIncrease:{str:0,dex:2,con:1,int:0,wis:0},resilience:"poison",proficiencies:[]},{name:"human",flavourText:"Humans are the most adaptable and ambitious people among the common races. They have widely varying tastes, morals, and customs in different lands where they have settled. Wheyn they settle, though, they stay: they build cities to last for the ages.",toughnessIncrease:0,abilityIncrease:{str:1,dex:1,con:1,int:1,wis:1},resilience:"none",proficiencies:[]}]},686:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.default=[{name:"acid splash",effectValues:"1d6;2d6;3d6;4d6",amount:"1",effectValue_mod:"",effectType:"acid",effectShape:"",effectSize:1,range:5,target_saving_throw_type:"dex",if_target_saving_throw_success:"half_damage",if_target_saving_throw_fail:"full_damage",toCaster:"",turns:0},{name:"blur",effectValues:"",amount:"1",effectValue_mod:"",effectType:"aura;illusion",effectShape:"",effectSize:1,range:0,target_saving_throw_type:"",if_target_saving_throw_success:"",if_target_saving_throw_fail:"",toCaster:"advantages",turns:20},{name:"burning hands",effectValues:"3d6;4d6;5d6;6d6",amount:"1",effectValue_mod:"",effectType:"fire",effectShape:"cone",effectSize:3,range:3,target_saving_throw_type:"dex",if_target_saving_throw_success:"half_damage",if_target_saving_throw_fail:"full_damage",toCaster:"",turns:0},{name:"cure wounds",effectType:"heal",effectValues:"1d8;2d8;3d8;4d8",amount:"1",effectValue_mod:"int",effectShape:"",effectSize:1,range:0,target_saving_throw_type:"",if_target_saving_throw_success:"",if_target_saving_throw_fail:"",toCaster:"",turns:0},{name:"detect magic",effectType:"aura;show_magic",effectValues:"",amount:"1",effectValue_mod:"",effectShape:"cube",effectSize:3,range:0,target_saving_throw_type:"",if_target_saving_throw_success:"",if_target_saving_throw_fail:"",toCaster:"",turns:600},{name:"fear",effectType:"aura",effectValues:"",amount:"1",effectValue_mod:"",effectShape:"cone",effectSize:1,range:5,target_saving_throw_type:"wis",if_target_saving_throw_success:"",if_target_saving_throw_fail:"escape",toCaster:"",turns:20},{name:"fireball",effectType:"fire",effectValues:"8d6;9d6;10d6",amount:"1",effectValue_mod:"",effectShape:"sphere",effectSize:2,range:7,target_saving_throw_type:"dex",if_target_saving_throw_success:"full_damage",if_target_saving_throw_fail:"half_damage",toCaster:"",turns:0},{name:"fire bolt",effectType:"fire",effectValues:"1d10;2d10;3d10;4d10",amount:"1",effectValue_mod:"",effectShape:"",effectSize:1,range:10,target_saving_throw_type:"",if_target_saving_throw_success:"",if_target_saving_throw_fail:"",toCaster:"",turns:0},{name:"guiding bolt",effectType:"lightning;disadvantage_next_turn",effectValues:"4d6;5d6;6d6;7d6",amount:"1",effectValue_mod:"",effectShape:"sphere",effectSize:1,range:10,target_saving_throw_type:"",if_target_saving_throw_success:"",if_target_saving_throw_fail:"",toCaster:"",turns:0},{name:"haste",effectType:"aura;transmutation",effectValues:"",amount:"1",effectValue_mod:"",effectShape:"",effectSize:1,range:0,target_saving_throw_type:"",if_target_saving_throw_success:"",if_target_saving_throw_fail:"",toCaster:"ac_add_2;speed_double;advantages",turns:20},{name:"holding person",effectType:"enchament",effectValues:"",amount:"1",effectValue_mod:"",effectShape:"",effectSize:1,range:4,target_saving_throw_type:"wis",if_target_saving_throw_success:"remove_effect",if_target_saving_throw_fail:"paralyzed",toCaster:"",turns:20},{name:"inflict wounds",effectType:"",effectValues:"3d10;4d10;5d10;6d10",amount:"1",effectValue_mod:"",effectShape:"",effectSize:1,range:4,target_saving_throw_type:"",if_target_saving_throw_success:"",if_target_saving_throw_fail:"",toCaster:"",turns:0},{name:"lightning",effectType:"lightning",effectValues:"3d10;4d10;5d10;6d10",amount:"1",effectValue_mod:"",effectShape:"line",effectSize:1,range:10,target_saving_throw_type:"dex",if_target_saving_throw_success:"half_damage",if_target_saving_throw_fail:"full_damage",toCaster:"",turns:0},{name:"magic missile",effectType:"force",effectValues:"1d4+1",amount:"3;4;5;6",effectValue_mod:"",effectShape:"",effectSize:1,range:5,target_saving_throw_type:"",if_target_saving_throw_success:"",if_target_saving_throw_fail:"",toCaster:"",turns:0},{name:"misty step",effectType:"transmutation",effectValues:"",amount:"1",effectValue_mod:"",effectShape:"",effectSize:1,range:4,target_saving_throw_type:"",if_target_saving_throw_success:"",if_target_saving_throw_fail:"",toCaster:"teleport_to_selected_location",turns:0},{name:"poison spray",effectType:"poison",effectValues:"1d12;2d12;3d12;4d12",amount:"1",effectValue_mod:"",effectShape:"",effectSize:1,range:4,target_saving_throw_type:"con",if_target_saving_throw_success:"",if_target_saving_throw_fail:"full_damage",toCaster:"",turns:0},{name:"ray of frost",effectType:"cold;reduce_speed",effectValues:"1d8;2d8;3d8;4d8",amount:"1",effectValue_mod:"",effectShape:"",effectSize:1,range:5,target_saving_throw_type:"",if_target_saving_throw_success:"",if_target_saving_throw_fail:"",toCaster:"",turns:0},{name:"resistance",effectType:"aura;add_value_to_saving_throws",effectValues:"1d4",amount:"1",effectValue_mod:"",effectShape:"",effectSize:1,range:0,target_saving_throw_type:"",if_target_saving_throw_success:"",if_target_saving_throw_fail:"",toCaster:"",turns:20},{name:"sacred flame",effectType:"",effectValues:"1d8;2d8;3d8;4d8",amount:"1",effectValue_mod:"",effectShape:"",effectSize:1,range:5,target_saving_throw_type:"dex",if_target_saving_throw_success:"",if_target_saving_throw_fail:"full_damage",toCaster:"",turns:0},{name:"shatter",effectType:"lightning",effectValues:"3d8;4d8;5d8;6d8",amount:"1",effectValue_mod:"",effectShape:"sphere",effectSize:2,range:5,target_saving_throw_type:"con",if_target_saving_throw_success:"half_damage",if_target_saving_throw_fail:"full_damage",toCaster:"",turns:0},{name:"shield of faith",effectType:"aura",effectValues:"",amount:"1",effectValue_mod:"",effectShape:"",effectSize:1,range:0,target_saving_throw_type:"",if_target_saving_throw_success:"",if_target_saving_throw_fail:"",toCaster:"ac_add_2",turns:200},{name:"shocking grasp",effectType:"lightning",effectValues:"1d8;2d8;3d8;4d8",amount:"1",effectValue_mod:"",effectShape:"",effectSize:1,range:1,target_saving_throw_type:"",if_target_saving_throw_success:"",if_target_saving_throw_fail:"",toCaster:"advantages",turns:0},{name:"thunderwave",effectType:"lightning",effectValues:"2d8;3d8;4d8;5d8",amount:"3",effectValue_mod:"",effectShape:"cube",effectSize:3,range:0,target_saving_throw_type:"con",if_target_saving_throw_success:"half_damage",if_target_saving_throw_fail:"full_damage;pushing_away",toCaster:"",turns:0},{name:"web",effectType:"",effectValues:"",amount:"1",effectValue_mod:"",effectShape:"",effectSize:2,range:11,target_saving_throw_type:"dex",if_target_saving_throw_success:"remove_effect",if_target_saving_throw_fail:"paralyzed",toCaster:"",turns:1200}]},204:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.default=[{name:"club",damage:"1d4",damageType:"bludgeoning",weight:2,rangeMax:1,wearableType:"one-handed",special:""},{name:"dagger",damage:"1d4",damageType:"piercing",weight:1,rangeMax:1,wearableType:"one-handed",special:""},{name:"greatclub",damage:"1d4",damageType:"bludgeoning",weight:10,rangeMax:1,wearableType:"two-handed",special:""},{name:"handaxe",damage:"1d6",damageType:"slashing",weight:2,rangeMax:1,wearableType:"one-handed",special:""},{name:"javelin",damage:"1d6",damageType:"piercing",weight:2,rangeMax:1,wearableType:"one-handed",special:""},{name:"light hammer",damage:"1d4",damageType:"bludgeoning",weight:2,rangeMax:1,wearableType:"one-handed",special:""},{name:"mace",damage:"1d6",damageType:"bludgeoning",weight:4,rangeMax:1,wearableType:"one-handed",special:""},{name:"quarterstaff",damage:"1d6",damageType:"bludgeoning",weight:4,rangeMax:1,wearableType:"one-handed",special:""},{name:"spear",damage:"1d6",damageType:"piercing",weight:3,rangeMax:1,wearableType:"one-handed",special:""},{name:"light crossbow",damage:"1d8",damageType:"piercing",weight:6,rangeMax:12,wearableType:"ranged",special:"loading"},{name:"dart",damage:"1d4",damageType:"piercing",weight:.25,rangeMax:6,wearableType:"ranged",special:""},{name:"shortbow",damage:"1d6",damageType:"piercing",weight:2,rangeMax:12,wearableType:"ranged",special:""},{name:"sling",damage:"1d4",damageType:"bludgeoning",weight:2,rangeMax:8,wearableType:"ranged",special:""}]},607:function(e,t,a){var i=this&&this.__awaiter||function(e,t,a,i){return new(a||(a=Promise))((function(s,r){function o(e){try{l(i.next(e))}catch(e){r(e)}}function n(e){try{l(i.throw(e))}catch(e){r(e)}}function l(e){var t;e.done?s(e.value):(t=e.value,t instanceof a?t:new a((function(e){e(t)}))).then(o,n)}l((i=i.apply(e,t||[])).next())}))},s=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.game=t.GameStatus=void 0,a(850);const r=s(a(801)),o=s(a(927)),n=a(382),l=s(a(423)),c=a(84),d=s(a(135)),h=a(557),u=s(a(529)),f=a(637),g=a(887),m=a(935),p=s(a(808)),_=a(792),v=a(107),y=a(928),w=a(409),T=s(a(5)),b=a(865);var x;!function(e){e[e.STARTUP=0]="STARTUP",e[e.IDLE=1]="IDLE",e[e.NEW_TURN=2]="NEW_TURN",e[e.VICTORY=3]="VICTORY",e[e.DEFEAT=4]="DEFEAT"}(x=t.GameStatus||(t.GameStatus={})),t.game=new class{constructor(){this.gameStatus=x.STARTUP,this.masterSeed=0,this.turns=0,this.mapx=80,this.mapy=80,this.canvas=(0,y.ensure)(document.querySelector("#screen")),this.ctx=(0,y.ensure)(this.canvas.getContext("2d")),this.ctx.font="12px system-ui",this.fontSize=12,this.ctx.textAlign="center",this.log=new T.default,this.lastKey="",this.depth=0,this.turns=0,this.width=80,this.height=40,this.actors=[],this.map=new l.default(this.mapx,this.mapy),this.camera=new c.Camera,this.camera.setCenter(this.width,this.height);const e=(0,y.ensure)(document.querySelector("#temp-image"));e.addEventListener("click",(()=>{e.classList.toggle("zoomed")}))}term(){return i(this,void 0,void 0,(function*(){this.log=new T.default,this.actors=[],this.map=new l.default(this.mapx,this.mapy),this.player=void 0}))}init(e,t=!0){var a,s,l,c,f,g,m,T,b,E,A,I,S;return i(this,void 0,void 0,(function*(){if((0,y.ensure)(this.map).generate(e,this.masterSeed,this.depth),e){let e=0;if(t){e=this.actors.push(new p.default(2,2,"@","hero",w.Colors.HERO))-1,this.player=this.actors[e],this.player.destructible=new v.PlayerDestructible(30,10,"your cadaver"),this.player.attacker=new u.default("1d4","1d1"),this.player.ai=new _.PlayerAI,this.player.abilities=new h.Abilities(18,15,10,8,12),this.player.container=new r.default(26),this.player.equipments=new o.default,this.player.fov=new d.default(this.mapx,this.mapy);const t=(0,n.createItem)({name:"leather armor",x:(0,y.ensure)(this.player).x,y:(0,y.ensure)(this.player).y}),i=(0,n.createItem)({name:"hide",x:(0,y.ensure)(this.player).x,y:(0,y.ensure)(this.player).y}),x=(0,n.createItem)({name:"handaxe",x:(0,y.ensure)(this.player).x,y:(0,y.ensure)(this.player).y}),S=(0,n.createItem)({name:"light crossbow",x:(0,y.ensure)(this.player).x,y:(0,y.ensure)(this.player).y}),C=(0,n.createItem)({name:"shortbow",x:(0,y.ensure)(this.player).x,y:(0,y.ensure)(this.player).y}),k=(0,n.createItem)({name:"club",x:(0,y.ensure)(this.player).x,y:(0,y.ensure)(this.player).y});null===(s=null===(a=this.player)||void 0===a?void 0:a.container)||void 0===s||s.add(t),null===(c=null===(l=this.player)||void 0===l?void 0:l.container)||void 0===c||c.add(i),null===(g=null===(f=this.player)||void 0===f?void 0:f.container)||void 0===g||g.add(x),null===(T=null===(m=this.player)||void 0===m?void 0:m.container)||void 0===T||T.add(S),null===(E=null===(b=this.player)||void 0===b?void 0:b.container)||void 0===E||E.add(C),null===(I=null===(A=this.player)||void 0===A?void 0:A.container)||void 0===I||I.add(k)}(0,y.ensure)(this.player).x=(0,y.ensure)(this.map).startX,(0,y.ensure)(this.player).y=(0,y.ensure)(this.map).startY,null===(S=(0,y.ensure)(this.player).fov)||void 0===S||S.fullClear(),e=this.actors.push(new p.default(0,0,">","stairs",w.Colors.STAIRS))-1,this.stairs=this.actors[e],this.stairs.blocks=!1,this.stairs.fovOnly=!1,this.stairs.x=(0,y.ensure)(this.map).stairsX,this.stairs.y=(0,y.ensure)(this.map).stairsY,this.sendToBack(this.stairs),this.log.add("Welcome stranger!"),this.log.add("Need help? Press '?'",w.Colors.HILIGHT_TEXT)}else this.log.add("Welcome back stranger!"),this.log.add("Need help? Press '?'",w.Colors.HILIGHT_TEXT);this.gameStatus=x.STARTUP}))}nextLevel(){return i(this,void 0,void 0,(function*(){this.depth++,this.log.add("You take steps down."),this.map=void 0,this.stairs=void 0;const e=this.player;this.actors=Array(),this.map=new l.default(this.mapx,this.mapy),this.init(!0,!1),this.actors.push(e),this.save()}))}newGame(){var e,t;return i(this,void 0,void 0,(function*(){this.masterSeed=parseInt(void 0)||(0,y.float2int)(134217727*Math.random());const[a,i,s,r,o,n]=yield(0,f.prepareNewJourney)();this.turns=0,this.depth=1,yield this.term(),yield this.init(!0,!0);const l=(0,y.ensure)(this.player);l.abilities=(0,y.ensure)(a),l.race=(0,y.ensure)(i),l.class=(0,y.ensure)(s),l.getProfiencies();const c=(0,m.getRaceNameByIndex)(i),d=(0,g.getClassNameByIndex)(s),u=`${null===(e=this.player)||void 0===e?void 0:e.name} the ${c} ${d}`;l.name=u;const p=a.getBonus(h.ABILITIES.CON);(0,y.ensure)(l.destructible).maxHP=r+p,(0,y.ensure)(l.destructible).hp=null===(t=(0,y.ensure)(l.destructible))||void 0===t?void 0:t.maxHP,(0,y.ensure)(l.destructible).hpPerLevel=o,(0,y.ensure)(l.destructible).hpPerLevelBonuses=n,yield this.save()}))}continueGame(){return i(this,void 0,void 0,(function*(){if(null!==window.localStorage.getItem("seed")){null===window.localStorage.getItem("version")&&window.localStorage.setItem("version","v0.0.1.15a"),this.masterSeed=parseInt((0,y.ensure)(window.localStorage.getItem("seed"))),this.depth=parseInt((0,y.ensure)(window.localStorage.getItem("depth"))),this.turns=parseInt((0,y.ensure)(window.localStorage.getItem("turns"))),yield this.init(!1);const e=JSON.parse(window.localStorage.getItem("actors")||"[]");for(const t of e){const e=this.actors.push(new p.default(t.x,t.y,t.ch,t.name,t.color))-1;if(t.fov&&(this.actors[e].fov=new d.default(this.mapx,this.mapy),(0,y.ensure)(this.actors[e].fov).mapped=t.fov.mapped),t.container){this.actors[e].container=yield new r.default(26);for(const a of t.container.inventory){const t=(0,y.ensure)(this.actors[e].container).inventory.push(new p.default(a.x,a.y,a.ch,a.name,a.color))-1;(0,y.ensure)(this.actors[e].container).inventory[t]=(0,n.createItem)({name:a.name,x:a.x,y:a.y})}}if(t.equipments){this.actors[e].equipments=new o.default;for(const a of t.equipments.items)(0,y.ensure)(this.actors[e].equipments).add((0,n.createItem)({name:a.name,x:a.x,y:a.y}))}if(t.abilities){const a=t.abilities;this.actors[e].abilities=new h.Abilities(a.str,a.dex,a.con,a.int,a.wis)}t.attacker&&(this.actors[e].attacker=new u.default(t.attacker.power_melee,t.attacker.power_range),(0,y.ensure)(this.actors[e].attacker).rangeAttack_range=t.attacker.rangeAttack_range),t.pickable&&(t.armor||t.weapon?this.actors[e]=(0,n.createItem)({name:t.name,x:t.x,y:t.y}):this.actors[e].create(t)),"stairs"===t.name&&(this.stairs=this.actors[e],this.stairs.fovOnly=!1),"door"===t.name&&(this.actors[e].blocks=t.blocks),t.destructible&&("player"===t.destructible.type&&(this.player=this.actors[e],this.actors[e].destructible=new v.PlayerDestructible(30,10,"player corpse"),this.actors[e].ai=new _.PlayerAI,(0,y.ensure)(this.actors[e].destructible).xp=t.destructible.xp,(0,y.ensure)(this.actors[e].destructible).hpPerLevel=t.destructible.hpPerLevel,(0,y.ensure)(this.actors[e].destructible).hpPerLevelBonuses=t.destructible.hpPerLevelBonuses,(0,y.ensure)(this.actors[e].destructible).hp=t.destructible.hp,(0,y.ensure)(this.actors[e].destructible).maxHP=t.destructible.maxHP,(0,y.ensure)(this.actors[e].destructible).defense=t.destructible.defense,(0,y.ensure)(this.actors[e].destructible).corpseName=t.destructible.corpseName),"monster"===t.destructible.type&&(this.actors[e].destructible=new v.MonsterDestructible(1,1,"monster corpse",0),(0,y.ensure)(this.actors[e].destructible).xp=t.destructible.xp,(0,y.ensure)(this.actors[e].destructible).hp=t.destructible.hp,(0,y.ensure)(this.actors[e].destructible).maxHP=t.destructible.maxHP,(0,y.ensure)(this.actors[e].destructible).defense=t.destructible.defense,(0,y.ensure)(this.actors[e].destructible).corpseName=t.destructible.corpseName,t.destructible.hp<=0&&(this.actors[e].blocks=!1),this.actors[e].ai=new _.MonsterAI))}}}))}load(){return i(this,void 0,void 0,(function*(){"v0.0.1.15a"!==window.localStorage.getItem("version")&&window.localStorage.clear(),this.menu=new b.Menu,this.menu.clear(),window.localStorage.getItem("depth")&&this.menu.addItem(b.MenuItemCode.CONTINUE,"Continue"),this.menu.addItem(b.MenuItemCode.NEW_GAME,"New Game");let e=0,t=-1;for(;;){this.clear(),this.renderVersion(),this.drawChar(">",this.width/2-12,10+e,w.Colors.MENU_CURSOR);for(let e=0;e<this.menu.items.length;e++)this.drawText(this.menu.items[e].label,this.width/2-10,10+e);const a=yield this.getch();if("ArrowDown"===a&&e++,"ArrowUp"===a&&e--,"Enter"===a){t=this.menu.items[e].code;break}e%=this.menu.items.length,e<0&&(e=this.menu.items.length-1)}-1!=t&&(t===b.MenuItemCode.NEW_GAME&&(yield this.newGame()),t===b.MenuItemCode.CONTINUE&&(yield this.continueGame()))}))}save(){return i(this,void 0,void 0,(function*(){const e=(0,y.ensure)(this.player);(0,y.ensure)(e.destructible).isDead()?window.localStorage.clear():((0,y.ensure)(this.map).save(),window.localStorage.setItem("playerID",this.actors.indexOf(e).toString()),window.localStorage.setItem("turns",this.turns.toString()),window.localStorage.setItem("actors",JSON.stringify(this.actors)),window.localStorage.setItem("version","v0.0.1.15a"))}))}clear(e=w.Colors.BACKGROUND){this.ctx.fillStyle=e,this.ctx.fillRect(0,0,this.width*this.fontSize,this.height*this.fontSize),this.ctx.fillRect(0,this.height*this.fontSize,this.width*this.fontSize,this.canvas.height-this.height*this.fontSize)}saveImage(){const e=this.width,t=this.height,a=this.camera.x,i=this.camera.y;this.width=this.mapx,this.height=this.mapy,(0,y.ensure)(document.querySelector("#temp-image")).classList.remove("hidden");const s=(0,y.ensure)(document.querySelector("#temp-image-canvas"));this.canvas=s,this.ctx=(0,y.ensure)(this.canvas.getContext("2d")),this.ctx.canvas.width=this.mapx*this.fontSize,this.ctx.canvas.height=this.mapy*this.fontSize,this.camera.x=0,this.camera.y=0,this.clear(),(0,y.ensure)(this.map).render();for(let e=0;e<this.actors.length;e++)this.actors[e].render();this.renderLighting(),this.canvas=(0,y.ensure)(document.getElementById("screen")),this.ctx=(0,y.ensure)(this.canvas.getContext("2d")),this.width=e,this.height=t,this.camera.x=a,this.camera.y=i}drawChar(e,t,a,i=w.Colors.BACKGROUND){t<0||a<0||t>this.width||a>this.height||(this.ctx.textAlign="center",this.ctx.fillStyle=w.Colors.BACKGROUND,this.ctx.fillRect(t*this.fontSize-this.fontSize/2,a*this.fontSize,this.fontSize,this.fontSize),this.ctx.fillStyle=i,this.ctx.fillText(e,t*this.fontSize,a*this.fontSize+this.fontSize))}drawRectangle(e,t,a=w.Colors.BACKGROUND,i){if(e<0||t<0||e>this.width||t>this.height)return;let s=i.toString(16);0===s.length&&(s="00"),s.length<2&&(s="0"+s),this.ctx.textAlign="center",this.ctx.fillStyle=a+s,this.ctx.fillRect(e*this.fontSize-this.fontSize/2,t*this.fontSize,this.fontSize,this.fontSize),this.ctx.fillStyle="#FFFFFF"}drawText(e,t,a,i=w.Colors.DEFAULT_TEXT,s="left"){this.ctx.textAlign=s,this.ctx.fillStyle=w.Colors.BACKGROUND,this.ctx.fillStyle=i,this.ctx.fillText(e,t*this.fontSize,a*this.fontSize+this.fontSize)}run(){return i(this,void 0,void 0,(function*(){for((0,y.debugInit)();;)for(yield this.load(),yield this.gameloop(),yield this.save(),this.log.add("Press Esc to restart"),this.render();"Escape"!==(yield this.getch()););}))}waitingKeypress(){return new Promise((e=>{document.addEventListener("keydown",(function a(i){i.preventDefault(),0!==i.keyCode&&(document.removeEventListener("keydown",a),t.game.lastKey=i.key,e())}))}))}getch(){return i(this,void 0,void 0,(function*(){yield this.waitingKeypress();const e=this.lastKey;return this.lastKey="",(0,y.ensure)(document.querySelector("#temp-image")).classList.remove("zoomed"),e}))}render(){this.clear(),(0,y.ensure)(this.map).render();for(let e=0;e<this.actors.length;e++)this.actors[e].render();this.renderLighting(),this.renderUI()}renderLighting(){var e,t,a;for(let i=0;i<this.mapy;i++)for(let s=0;s<this.mapx;s++){const r=(0,y.ensure)(null===(t=null===(e=this.player)||void 0===e?void 0:e.fov)||void 0===t?void 0:t.getLight(s,i)),o=s+this.camera.x,n=i+this.camera.y;this.drawRectangle(o,n,null===(a=this.map)||void 0===a?void 0:a.ambienceColor,r>255?255:(0,y.float2int)(.15*r))}}renderUI(){var e,t,a,i,s,r,o,n,l,c,d,u;for(let e=0;e<this.width;e++)this.drawChar("-",e,this.height,w.Colors.MENU_BORDER);const f=(0,y.ensure)(this.player),g=(0,y.ensure)(null===(e=f.destructible)||void 0===e?void 0:e.hp),m=null===(t=f.destructible)||void 0===t?void 0:t.defense,p=null===(a=f.attacker)||void 0===a?void 0:a.power_melee,_=null===(i=f.attacker)||void 0===i?void 0:i.power_range,v=null===(s=f.attacker)||void 0===s?void 0:s.rangeAttack_range,T=(0,y.ensure)(null===(r=f.destructible)||void 0===r?void 0:r.maxHP),b=(0,y.ensure)(this.map).depth,x=(0,y.ensure)(this.turns),E=null===(o=f.destructible)||void 0===o?void 0:o.xp;this.drawText(`HP: ${g}/${T}`,1,this.height+1,g<T/100*10?w.Colors.HP_10_PERCENT:g<T/100*25?w.Colors.HP_25_PERCENT:g<T/100*50?w.Colors.HP_50_PERCENT:g<T/100*95?w.Colors.HP_95_PERCENT:w.Colors.HP_MAX),this.drawText(`AC: ${m}`,7,this.height+1),this.drawText(`ATT M: ${p}`,13,this.height+1),this.drawText(`ATT R: ${_}`,13,this.height+2),this.drawText(`Range: ${v}`,19,this.height+2),this.drawText(`Depth: ${b}`,this.width-6,this.height+1),this.drawText(`Turn: ${x}`,this.width-6,this.height+2),this.drawText(`EXP: ${E} / ${null===(n=f.ai)||void 0===n?void 0:n.getNextLevelXP()}`,1,this.height+2),this.drawText(`${(0,y.capitalize)(null===(l=(0,y.ensure)(this.player))||void 0===l?void 0:l.name)}`,60,this.height+1);const A=null===(c=this.player)||void 0===c?void 0:c.abilities;this.drawText(`STR: ${null==A?void 0:A.str} (${null==A?void 0:A.getBonusWithSign(h.ABILITIES.STR)})`,19,this.height+1),this.drawText(`DEX: ${null==A?void 0:A.dex} (${null==A?void 0:A.getBonusWithSign(h.ABILITIES.DEX)})`,27,this.height+1),this.drawText(`CON: ${null==A?void 0:A.con} (${null==A?void 0:A.getBonusWithSign(h.ABILITIES.CON)})`,35,this.height+1),this.drawText(`INT: ${null==A?void 0:A.int} (${null==A?void 0:A.getBonusWithSign(h.ABILITIES.INT)})`,43,this.height+1),this.drawText(`WIS: ${null==A?void 0:A.wis} (${null==A?void 0:A.getBonusWithSign(h.ABILITIES.WIS)})`,51,this.height+1),this.log.render(),this.drawText("Weared",this.width-20,this.height+3);let I=0;if(f.equipments&&(null===(d=f.equipments)||void 0===d?void 0:d.items.length)>0)for(const e of(0,y.ensure)(null===(u=f.equipments)||void 0===u?void 0:u.items))this.drawText((0,y.capitalize)(e.name),this.width-20,this.height+4+I),I++;this.renderVersion()}renderVersion(){this.drawText("Commit ID: 88af8d8 | Version: v0.0.1.15a",this.ctx.canvas.width/this.fontSize-2,this.ctx.canvas.height/this.fontSize-2,w.Colors.VERSION,"right")}gameloop(){var e,t,a,s,r,o;return i(this,void 0,void 0,(function*(){for(;;){if(this.gameStatus===x.STARTUP&&(null===(e=this.player)||void 0===e||e.computeFov(),this.camera.compute((0,y.ensure)(null===(t=this.player)||void 0===t?void 0:t.x),(0,y.ensure)(null===(a=this.player)||void 0===a?void 0:a.y)),this.render()),this.gameStatus=x.IDLE,yield null===(s=this.player)||void 0===s?void 0:s.update(),this.gameStatus===x.NEW_TURN){for(const e of this.actors)e!==this.player&&(yield e.update());this.turns++}if(this.render(),this.gameStatus===x.DEFEAT){this.drawText("DEFEAT!",this.width/2-3,this.height/2,w.Colors.DEFEAT),this.log.add("DEFEAT",w.Colors.DEFEAT),null===(o=null===(r=this.player)||void 0===r?void 0:r.fov)||void 0===o||o.showAll(),this.saveImage(),setTimeout((()=>{(0,y.ensure)(document.querySelector("#temp-image")).classList.add("zoomed")}),1e3);break}}}))}removeActor(e){for(let t=0;t<this.actors.length;t++)if(this.actors[t]===e)return void this.actors.splice(t,1)}sendToBack(e){this.removeActor(e),this.actors.unshift(e)}getClosestMonster(e,t,a){let i=null,s=1e5;for(const r of this.actors)if(r!=this.player&&r.destructible&&!r.destructible.isDead()){const o=r.getDistance(e,t);o<s&&(o<=a||0==a)&&(s=o,i=r)}return i}getActor(e,t){for(const a of this.actors)if(a.x===e&&a.y===t&&a.destructible&&!a.destructible.isDead())return a;return null}getAnyActor(e,t){for(const a of this.actors)if(a.x===e&&a.y===t)return a;return null}pickATile(e,t,a=0){var s,r;return i(this,void 0,void 0,(function*(){let i=e,o=t,n=!1;for(;;){this.render(),(null===(r=null===(s=this.player)||void 0===s?void 0:s.fov)||void 0===r?void 0:r.isInFov(i,o))&&(0==a||this.player.getDistance(i,o)<=a)?(this.drawChar("+",i+this.camera.x,o+this.camera.y,w.Colors.ALLOWED),n=!0):(this.drawChar("+",i+this.camera.x,o+this.camera.y,w.Colors.DISALLOWED),n=!1);const e=yield this.getch();if("ArrowLeft"===e&&i--,"ArrowRight"===e&&i++,"ArrowUp"===e&&o--,"ArrowDown"===e&&o++,"Escape"===e)break;if("Enter"===e&&n)return[!0,i,o]}return[!1,i,o]}))}renderMenuBackground({title:e,x:t,y:a,w:i,h:s}){for(let e=0;e<s;e++)for(let r=0;r<i;r++)(0===e||e===s-1)&&r>0&&r<i-1?this.drawChar("-",r+t,e+a,w.Colors.MENU_BORDER):(0===r||r===i-1)&&e>0&&e<s-1?this.drawChar("|",r+t,e+a,w.Colors.MENU_BORDER):0===e||0===r||e===s-1||r===i-1?this.drawChar("+",r+t,e+a,w.Colors.MENU_BORDER):this.drawChar(" ",r+t,e+a,w.Colors.MENU_BORDER);for(let s=0;s<e.length;s++)this.drawChar(e.charAt(s),t+i/2-e.length/2+s,a,w.Colors.DEFAULT_TEXT)}},t.game.run()},801:(e,t,a)=>{Object.defineProperty(t,"__esModule",{value:!0});const i=a(607),s=a(524),r=a(889),o=a(692),n=a(928);t.default=class{constructor(e){this.size=e,this.inventory=[]}add(e){return!(this.size>0&&this.inventory.length>=this.size||(this.inventory.push(e),0))}remove(e){for(let t=0;t<this.inventory.length;t++)if(this.inventory[t]===e)return void this.inventory.splice(t,1)}render(){var e,t,a,l;i.game.renderMenuBackground({title:"INVENTORY",x:15,y:4,w:45,h:30});let c="a",d=0;for(const h of this.inventory){i.game.drawText(`${c} ) ${(0,n.capitalize)(h.name)}`,16,6+d);const u=(0,n.ensure)(h.pickable).weight;i.game.drawText(`${u} lb`,54,6+d),c=String.fromCharCode(c.charCodeAt(0)+1);let f="";if(h.armor&&(h.armor.armorType===r.ArmorType.SHIELD&&(f=`AC: ${h.armor.armorClass}, shield`),h.armor.armorType===r.ArmorType.LIGHT_ARMOR&&(f=`AC: ${h.armor.armorClass}, light armor`),h.armor.armorType===r.ArmorType.MEDIUM_ARMOR&&(f=`AC: ${h.armor.armorClass}, medium armor`),h.armor.armorType===r.ArmorType.HEAVY_ARMOR&&(f=`AC: ${h.armor.armorClass}, heavy armor`)),h.weapon&&(h.weapon.damageType===o.DamageType.BLUDGEONING&&(f=`damage: ${h.weapon.damage}, bludgeoning`),h.weapon.damageType===o.DamageType.PIERCING&&(f=`damage: ${h.weapon.damage}, piercing`),h.weapon.damageType===o.DamageType.SLASHING&&(f=`damage: ${h.weapon.damage}, slashing`)),null===(e=h.pickable)||void 0===e?void 0:e.effect){let e="";"HealthEffect"===h.pickable.effectName&&(e=h.pickable.effect.amount>0?`healing: ${Math.abs(h.pickable.effect.amount)}`:`damage: ${Math.abs(h.pickable.effect.amount)}`),"AiChangeEffect"===h.pickable.effectName&&(e=`confused ${h.pickable.effect.newAi.nbTurns} turns`),"scroll of map"===h.name&&(e="Reveal current map"),f+=`${e}`,(null===(t=h.pickable)||void 0===t?void 0:t.selector)&&(f+=", ")}if(null===(a=h.pickable)||void 0===a?void 0:a.selector){let e="";const t=h.pickable.selector.range;h.pickable.selector.type===s.SelectorType.CLOSEST_MONSTER&&(e="closest enemy"),h.pickable.selector.type===s.SelectorType.SELECTED_MONSTER&&(e="selected monster"),h.pickable.selector.type===s.SelectorType.SELECTED_RANGE&&(e="selected range"),h.pickable.selector.type===s.SelectorType.WEARER_RANGE&&(e="wearer range"),f+=`${e}, range: ${t}`}(null===(l=h.pickable)||void 0===l?void 0:l.effect)&&"Wearable"===h.pickable.effectName&&(h.pickable.effect.type===s.WearableType.ONEHANDED_WEAPON&&(f+=", one-handed"),h.pickable.effect.type===s.WearableType.TWOHANDED_WEAPON&&(f+=", two-handed"),h.pickable.effect.type===s.WearableType.SHIELD&&(f+=", shield"),h.pickable.effect.type===s.WearableType.ARMOR&&(f+=", armor")),i.game.drawText(`${(0,n.capitalize)(f)}`,30,6+d),d++}}}},927:(e,t,a)=>{Object.defineProperty(t,"__esModule",{value:!0});const i=a(524),s=a(928);t.default=class{constructor(){this.items=[]}add(e){return this.items.push(e),!0}takeOff(e){var t,a;for(let i=0;i<this.items.length;i++)if((null===(t=this.items[i].pickable)||void 0===t?void 0:t.effect)&&(null===(a=this.items[i].pickable)||void 0===a?void 0:a.effect.type)===e)return this.items.splice(i,1)[0]}thisTypeIsWeared(e){var t,a;for(let i=0;i<this.items.length;i++)if((null===(t=this.items[i].pickable)||void 0===t?void 0:t.effect)&&(null===(a=this.items[i].pickable)||void 0===a?void 0:a.effect.type)===e)return this.items[i]}getRangeWeapon(){var e,t;for(let a=0;a<this.items.length;a++)if((null===(e=this.items[a].pickable)||void 0===e?void 0:e.effect)&&(null===(t=this.items[a].pickable)||void 0===t?void 0:t.effect.type)===i.WearableType.RANGED_WEAPON)return this.items[a]}getMeleeWeapon(){var e,t,a;for(let s=0;s<this.items.length;s++)if((null===(e=this.items[s].pickable)||void 0===e?void 0:e.effect)&&((null===(t=this.items[s].pickable)||void 0===t?void 0:t.effect.type)===i.WearableType.ONEHANDED_WEAPON||(null===(a=this.items[s].pickable)||void 0===a?void 0:a.effect.type)===i.WearableType.TWOHANDED_WEAPON))return this.items[s]}getAC(){let e=0;for(const t of this.items)t.armor&&(e+=t.armor.armorClass);return e}getMeleePower(){let e="1d3";for(const t of this.items)t.weapon&&t.pickable&&(t.pickable.effect.type===i.WearableType.ONEHANDED_WEAPON||t.pickable.effect.type===i.WearableType.TWOHANDED_WEAPON)&&(e=t.weapon.damage);return e}getRangePower(){let e="1d3";for(const t of this.items)t.weapon&&t.pickable&&t.pickable.effect.type===i.WearableType.RANGED_WEAPON&&(e=t.weapon.damage);return e}update(e){var t,a;e.destructible&&((0,s.ensure)(null==e?void 0:e.destructible).defense=this.getAC(),(0,s.ensure)(e.attacker).power_melee=this.getMeleePower(),(0,s.ensure)(e.attacker).power_range=this.getRangePower(),this.getRangeWeapon()&&((0,s.ensure)(e.attacker).rangeAttack_range=(0,s.ensure)(null===(a=null===(t=this.getRangeWeapon())||void 0===t?void 0:t.weapon)||void 0===a?void 0:a.rangeMax)))}}},382:function(e,t,a){var i=this&&this.__createBinding||(Object.create?function(e,t,a,i){void 0===i&&(i=a),Object.defineProperty(e,i,{enumerable:!0,get:function(){return t[a]}})}:function(e,t,a,i){void 0===i&&(i=a),e[i]=t[a]}),s=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),r=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var a in e)"default"!==a&&Object.prototype.hasOwnProperty.call(e,a)&&i(t,e,a);return s(t,e),t},o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.createItem=t.items=t.weapons=t.armors=void 0;const n=o(a(260)),l=o(a(886)),c=o(a(391)),d=o(a(204)),h=r(a(524)),u=r(a(889)),f=r(a(692)),g=o(a(808)),m=a(792),p=a(928),_=a(409);t.armors=l.default,t.weapons=d.default,t.items=c.default,t.createItem=e=>{let a,i,s,r="?",o=n.default.default_item,l=!1,c=u.ArmorType.LIGHT_ARMOR;if((e=>!!t.weapons.find((t=>t.name===e)))(e.name)){const i=(0,p.ensure)((e=>t.weapons.find((t=>t.name===e)))(e.name));let n=f.DamageType.BLUDGEONING,c=h.WearableType.ONEHANDED_WEAPON;"bludgeoning"===i.damageType&&(n=f.DamageType.BLUDGEONING),"slashing"===i.damageType&&(n=f.DamageType.SLASHING),"piercing"===i.damageType&&(n=f.DamageType.PIERCING),"one-handed"===i.wearableType&&(c=h.WearableType.ONEHANDED_WEAPON,r="f"),"two-handed"===i.wearableType&&(c=h.WearableType.TWOHANDED_WEAPON,r="F"),"ranged"===i.wearableType&&(c=h.WearableType.RANGED_WEAPON,r="â‚¬"),s=new f.default({name:e.name,damage:null==i?void 0:i.damage,damageType:n,rangeMax:i.rangeMax,needReload:"loading"===i.special}),o=_.Colors.WEAPON_ITEM,l=!1,a=new h.default({selector:void 0,effect:new h.Wearable(c),weight:i.weight})}else if((e=>!!t.armors.find((t=>t.name===e)))(e.name)){const s=(0,p.ensure)((e=>t.armors.find((t=>t.name===e)))(e.name));"light"===s.armorType&&(c=u.ArmorType.LIGHT_ARMOR),"medium"===s.armorType&&(c=u.ArmorType.MEDIUM_ARMOR),"heavy"===s.armorType&&(c=u.ArmorType.HEAVY_ARMOR),"shield"===s.armorType&&(c=u.ArmorType.SHIELD),i=new u.default({name:e.name,ac:s.ac,armorClassAbilityType:c===u.ArmorType.HEAVY_ARMOR?"str":"dex",armorType:c,requirementStrenght:0}),r="L",o=_.Colors.ARMOR_ITEM,l=!1,a=new h.default({selector:void 0,effect:new h.Wearable(c===u.ArmorType.SHIELD?h.WearableType.SHIELD:h.WearableType.ARMOR),weight:s.weight})}else if((e=>!!t.items.find((t=>t.name===e)))(e.name)){const i=(0,p.ensure)((e=>t.items.find((t=>t.name===e)))(e.name));let s,n;r=i.ch,o=i.color,l=!1,"selected range"===i.selector.type&&(s=new h.TargetSelector(h.SelectorType.SELECTED_RANGE,i.selector.range)),"selected monster"===i.selector.type&&(s=new h.TargetSelector(h.SelectorType.SELECTED_MONSTER,i.selector.range)),"closest monster"===i.selector.type&&(s=new h.TargetSelector(h.SelectorType.CLOSEST_MONSTER,i.selector.range)),"health"===i.effect.type&&(n=new h.HealthEffect(i.effect.amount,i.message)),"map clear"===i.effect.type&&(n=new h.MapClearEffect(i.message)),"change ai"===i.effect.type&&(n=new h.AiChangeEffect(new m.ConfusedMonsterAi(i.effect.amount),i.message)),a=new h.default({selector:s,effect:n,weight:i.weight})}else console.error(`${name} not found.`);const d=new g.default(e.x,e.y,r,e.name,o);return d.blocks=l,d.pickable=a,d.armor=i,d.weapon=s,d}},524:function(e,t,a){var i=this&&this.__awaiter||function(e,t,a,i){return new(a||(a=Promise))((function(s,r){function o(e){try{l(i.next(e))}catch(e){r(e)}}function n(e){try{l(i.throw(e))}catch(e){r(e)}}function l(e){var t;e.done?s(e.value):(t=e.value,t instanceof a?t:new a((function(e){e(t)}))).then(o,n)}l((i=i.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.AiChangeEffect=t.HealthEffect=t.Wearable=t.WearableType=t.MapClearEffect=t.TargetSelector=t.SelectorType=void 0;const s=a(607),r=a(928),o=a(409);var n,l;!function(e){e[e.NONE=0]="NONE",e[e.CLOSEST_MONSTER=1]="CLOSEST_MONSTER",e[e.SELECTED_MONSTER=2]="SELECTED_MONSTER",e[e.WEARER_RANGE=3]="WEARER_RANGE",e[e.SELECTED_RANGE=4]="SELECTED_RANGE"}(n=t.SelectorType||(t.SelectorType={})),t.TargetSelector=class{constructor(e,t){this.type=e,this.range=t}selectTargets(e,t){return i(this,void 0,void 0,(function*(){const a=()=>i(this,void 0,void 0,(function*(){const[a,i,r]=yield s.game.pickATile(e.x,e.y);if(void 0===a||!1===a)return;const o=s.game.getActor(i,r);o&&o.destructible&&!o.destructible.isDead()&&o.getDistance(i,r)<=this.range&&t.push(o)})),r=()=>{const a=s.game.getClosestMonster(e.x,e.y,this.range);a&&t.push(a)},o=()=>i(this,void 0,void 0,(function*(){const[a,i,r]=yield s.game.pickATile(e.x,e.y);if(!1===a)return;const o=s.game.getActor(i,r);o&&t.push(o)})),l=()=>{for(const a of s.game.actors)a!=e&&a.destructible&&!a.destructible.isDead()&&a.getDistance(e.x,e.y)<=this.range&&t.push(a)};switch(this.type){case n.CLOSEST_MONSTER:r();break;case n.SELECTED_MONSTER:yield o();break;case n.WEARER_RANGE:l();break;case n.SELECTED_RANGE:yield a();break;default:console.error(`Error with selectorType: ${this.type}`)}0===t.length&&s.game.log.add("No enemy is close enough")}))}},t.MapClearEffect=class{constructor(e){this.message=e}applyTo(e){var t,a,i;return(0,r.ensure)(e),null===(a=null===(t=s.game.player)||void 0===t?void 0:t.fov)||void 0===a||a.showAll(),null===(i=s.game.player)||void 0===i||i.computeFov(),!0}},(l=t.WearableType||(t.WearableType={}))[l.ARMOR=0]="ARMOR",l[l.SHIELD=1]="SHIELD",l[l.ONEHANDED_WEAPON=2]="ONEHANDED_WEAPON",l[l.TWOHANDED_WEAPON=3]="TWOHANDED_WEAPON",l[l.RANGED_WEAPON=4]="RANGED_WEAPON",t.Wearable=class{constructor(e){this.type=e}applyTo(e){return(0,r.ensure)(e),console.log("apply to:"+e.name),!1}},t.HealthEffect=class{constructor(e,t){this.amount=0,this.amount=e,this.message=t}applyTo(e){if(!e||!e.destructible)return!1;if(this.amount>0){if(e.destructible.heal(this.amount)>0)return this.message&&s.game.log.add(this.message,o.Colors.HEALED),!0}else if(this.message&&-this.amount-e.destructible.defense>0&&s.game.log.add(this.message),e.destructible.takeDamage(e,-this.amount)>0)return!0;return!1}},t.AiChangeEffect=class{constructor(e,t){this.message=t,this.newAi=e}applyTo(e){return this.newAi.applyTo(e),this.message&&s.game.log.add(this.message),!0}},t.default=class{constructor(e){this.selector=null==e?void 0:e.selector,this.effect=null==e?void 0:e.effect,this.weight=null==e?void 0:e.weight,void 0!==this.selector&&(this.selectorName=this.selector.constructor.name),void 0!==this.effect&&(this.effectName=this.effect.constructor.name)}pick(e,t){return!(!t.container||!t.container.add(e)||(s.game.removeActor(e),0))}use(e,t){var a;return i(this,void 0,void 0,(function*(){s.game.log.add(`You use a ${e.name}`);const i=Array();this.selector?yield this.selector.selectTargets(t,i):i.push(t);let r=!1;for(const e of i)(null===(a=this.effect)||void 0===a?void 0:a.applyTo(e))&&(r=!0);return r&&t.container&&t.container.remove(e),r}))}drop(e,t){t.container&&(t.container.remove(e),s.game.actors.push(e),s.game.sendToBack(e),e.x=t.x,e.y=t.y,s.game.log.add(`${t.name} drops a ${e.name}`))}wear(e,t){if((e.armor||e.weapon)&&t.container&&t.equipments&&e.pickable){t.container.remove(e);const a=t.equipments.takeOff(e.pickable.effect.type);t.container&&a&&(s.game.log.add(`take off a ${a.name}`),t.container.add(a)),t.equipments.add(e),s.game.log.add(`${t.name} wear a ${e.name}`),t.equipments.update(t)}}}},10:function(e,t,a){var i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const s=i(a(705)),r=a(928),o=i(a(451)),n=i(a(357)),l=new o.default;t.default=class{constructor(e,t,a,i,s=5){this.maxLevel=s,this.rootContainer=new n.default(e+1,t+1,a-2,i-2),this.rows=i,this.cols=a,this.map=[],this.doorPlaces=[],this.tempRooms=[];for(let e=0;e<this.rows;e++)for(let t=0;t<this.cols;t++){const a=this.cols*e+t;this.map[a]=1}this.tree=this.Devide(this.rootContainer,0),this.rooms=this.tree.GetLeafs(),this.CreateRooms(),this.ConnectRooms(this.tree)}RandomSplit(e){let t,a,i=!l.getInt(0,1);if(i=e.w>e.h&&e.w/e.h>=.05,i){const i=l.getInt(.3*e.w,.6*e.w);t=new n.default(e.x,e.y,i,e.h),a=new n.default(e.x+i,e.y,e.w-i,e.h)}else{const i=l.getInt(.3*e.h,.6*e.h);t=new n.default(e.x,e.y,e.w,i),a=new n.default(e.x,e.y+i,e.w,e.h-i)}return[t,a]}Devide(e,t){const a=new s.default(e);if(t<this.maxLevel){const i=this.RandomSplit(e);a.A=this.Devide(i[0],t+1),a.B=this.Devide(i[1],t+1)}return a}CreateRooms(){for(const e of this.rooms){const t=l.getInt(.5*e.w,.9*e.w),a=l.getInt(.5*e.h,.9*e.h),i=l.getInt(e.x,e.x+e.w-t),s=l.getInt(e.y,e.y+e.h-a),r=new n.default(i,s,i+t,s+a);this.tempRooms.push(r);for(let e=s;e<s+a;e++)for(let a=i;a<i+t;a++){const t=this.cols*e+a;this.map[t]=0}}}IsThereRoom(e,t){for(const a of this.tempRooms)if(e>=a.x&&t>=a.y&&e<=a.w&&t<=a.h)return!0;return!1}ConnectRooms(e){if(!e.A||!e.B)return!1;const t=(0,r.float2int)(e.A.leaf.GetCenterX()),a=(0,r.float2int)(e.A.leaf.GetCenterY()),i=(0,r.float2int)(e.B.leaf.GetCenterX()),s=(0,r.float2int)(e.B.leaf.GetCenterY());let o=!1,l=!1;for(let e=Math.min(t,i);e<=Math.max(t,i);e++){const t=this.cols*Math.max(a,s)+e;if(this.map[t]=0,o||!0!==this.IsThereRoom(e,Math.max(a,s))){if(!o&&!1===this.IsThereRoom(e,Math.max(a,s))&&!0===l){o=!0;const t=new n.default(e,Math.max(a,s),0,0);this.doorPlaces.push(t)}}else l=!0}o=!1;for(let e=Math.min(a,s);e<=Math.max(a,s);e++){const a=this.cols*e+Math.max(t,i);if(this.map[a]=0,o||!0!==this.IsThereRoom(Math.max(t,i),e)){if(!o&&!1===this.IsThereRoom(Math.max(t,i),e)&&!0===l){o=!0;const a=new n.default(Math.max(t,i),e,0,0);this.doorPlaces.push(a)}}else l=!0}this.ConnectRooms((0,r.ensure)(e.A)),this.ConnectRooms((0,r.ensure)(e.B))}}},705:function(e,t,a){var i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const s=i(a(357));class r extends s.default{constructor(e){super(e.x,e.y,e.w,e.h),this.A=void 0,this.B=void 0,this.leaf=e}GetLeafs(){return this.A&&this.B?[...this.A.GetLeafs(),...this.B.GetLeafs()]:[this.leaf]}}t.default=r},84:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.Camera=void 0,t.Camera=class{constructor(){this.centerX=0,this.centerY=0,this.x=0,this.y=0}setCenter(e,t){this.centerX=e/2,this.centerY=t/2}compute(e,t){this.x=this.centerX-e,this.y=this.centerY-t}}},135:(e,t,a)=>{Object.defineProperty(t,"__esModule",{value:!0});const i=a(607),s=a(928);t.default=class{constructor(e,t){this.width=e,this.height=t,this.mapped=new Array(this.width*this.height).fill(0),this.light=new Array(this.width*this.height).fill(0)}clear(){for(let e=0;e<this.width*this.height;e++)2===this.mapped[e]&&(this.mapped[e]=1,this.light[e]=128)}fullClear(){this.mapped=new Array(this.width*this.height).fill(0),this.light=new Array(this.width*this.height).fill(0)}showAll(){var e,t,a,r,o,n,l,c,d;this.mapped=new Array(this.width*this.height).fill(2);for(let h=1;h<this.height-1;h++)for(let u=1;u<this.width-1;u++)if(1==(null===(e=i.game.map)||void 0===e?void 0:e.isWall(u,h))){let e=0;if((null===(t=i.game.map)||void 0===t?void 0:t.isWall(u-1,h))&&e++,(null===(a=i.game.map)||void 0===a?void 0:a.isWall(u+1,h))&&e++,(null===(r=i.game.map)||void 0===r?void 0:r.isWall(u,h-1))&&e++,(null===(o=i.game.map)||void 0===o?void 0:o.isWall(u,h+1))&&e++,(null===(n=i.game.map)||void 0===n?void 0:n.isWall(u-1,h+1))&&e++,(null===(l=i.game.map)||void 0===l?void 0:l.isWall(u+1,h+1))&&e++,(null===(c=i.game.map)||void 0===c?void 0:c.isWall(u-1,h-1))&&e++,(null===(d=i.game.map)||void 0===d?void 0:d.isWall(u+1,h-1))&&e++,e>=8){const e=(0,s.float2int)(u)+(0,s.float2int)(h)*this.width;this.mapped[e]=0}}}compute(e,t,a){var r;this.clear();let o=0,n=0,l=0,c=0;this.mapped[e+t*this.width]=2,this.light[e+t*this.width]=0;for(let d=0;d<360;d++){o=Math.sin(d/3.1415*180),n=Math.cos(d/3.1415*180),l=e+.5,c=t+.5;for(let e=0;e<a&&(l+=o,c+=n,!(l<=0||l>=this.width||c<=0||c>=this.height));e++){const t=(0,s.float2int)(l)+(0,s.float2int)(c)*this.width;if(this.mapped[t]=2,this.light[t]=(0,s.float2int)(e*(128/a)),this.light[t]<0&&(this.light[t]=0),this.light[t]>512&&(this.light[t]=512),!(null===(r=i.game.map)||void 0===r?void 0:r.canWalk((0,s.float2int)(l),(0,s.float2int)(c))))break}}}getMapped(e,t){return e>=0&&t>=0&&e<this.width&&t<this.height?this.mapped[e+t*this.width]:2}getLight(e,t){return e>=0&&t>=0&&e<this.width&&t<this.height?this.light[e+t*this.width]:0}isInFov(e,t){return e>=0&&t>=0&&e<this.width&&t<this.height&&this.mapped[e+t*this.width]>1}}},423:function(e,t,a){var i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.random=void 0;const s=a(607),r=a(382),o=i(a(10)),n=a(127),l=i(a(808)),c=a(928),d=a(409),h=i(a(451)),u=i(a(357));t.random=new h.default;class f{constructor(){this.canWalk=!1,this.explored=!1}}t.default=class{constructor(e,t){this.startX=0,this.startY=0,this.stairsX=0,this.stairsY=0,this.levelSeed=0,this.depth=0,this.ROOM_MAX_SIZE=5,this.ROOM_MIN_SIZE=4,this.MAX_ROOM_MONSTERS=3,this.MAX_ROOM_ITEMS=2,this.width=e,this.height=t,this.templateDoors=[],this.tiles=new Array(this.width*this.height).fill(!1),this.ambienceColor="#AAAAAA"}save(){window.localStorage.setItem("seed",this.levelSeed.toString()),window.localStorage.setItem("depth",this.depth.toString())}isWall(e,t){const a=e+t*this.width;return!this.tiles[a].canWalk}setWall(e,t){this.tiles[e+t*this.width].canWalk=!1}canWalk(e,t){if(this.isWall(e,t))return!1;for(const a of s.game.actors)if(a.x===e&&a.y===t&&a.blocks)return!1;return!0}addMonster(e,a){const i=["bat","rat","jackal","lizard","kobold","giant rat"],r=["giant rat","orc","ghoul"];if(t.random.getInt(0,100)>5){const r=t.random.getInt(0,i.length);s.game.actors.push((0,n.createMonster)(i[r],e,a))}else{const i=t.random.getInt(0,r.length);s.game.actors.push((0,n.createMonster)(r[i],e,a))}}pushTo(e,t,a,i){const r=[];for(const a of s.game.actors)a.x===e&&a.y===t&&(a.pickable||a.destructible&&a.destructible.isDead())&&r.push(a);for(const e of r){if(!this.canWalk(e.x+a,e.y+i)){s.game.log.add("Can't push");break}e.x+=a,e.y+=i}return r.length>0}pullTo(e,t,a,i){if(!this.canWalk(e+a,t+i))return s.game.log.add("Can't pull"),!1;const r=[];for(const o of s.game.actors)o.x===e-a&&o.y===t-i&&(o.pickable||o.destructible&&o.destructible.isDead())&&r.push(o);for(const e of r)e.x+=a,e.y+=i;return r.length,!0}openCloseDoor(e,t){const a=s.game.getAnyActor(e,t);return!(!a||"door"!==a.name||(a.blocks=!a.blocks,a.blocks?(a.ch="D",s.game.log.add("a door is closed")):"#"===a.ch?(a.color=d.Colors.DOOR,a.ch="+",s.game.log.add("a secret door is opened!",d.Colors.HILIGHT_TEXT)):(a.ch="+",s.game.log.add("a door is opened")),0))}addDoor(e,a,i){const r=new l.default(e,a,i?"D":"+","door",d.Colors.DOOR);r.blocks=!0,(1==this.isWall(e-1,a)&&1==this.isWall(e+1,a)||1==this.isWall(e,a-1)&&1==this.isWall(e,a+1))&&(s.game.actors.push(r),s.game.sendToBack(r),t.random.getInt(0,100)<20&&(r.ch="#",r.color=d.Colors.WALL))}additem(e,a){const i=t.random.getInt(0,100);let o;i<70?t.random.getInt(0,100)<95?o=(0,r.createItem)({name:"health potion",x:e,y:a}):(o=(0,r.createItem)({name:"nutella bun",x:e,y:a}),console.log("Jossain haisoo nutella!")):o=i<80?(0,r.createItem)({name:"scroll of lighting bolt",x:e,y:a}):i<90?(0,r.createItem)({name:"scroll of fireball",x:e,y:a}):i<95?(0,r.createItem)({name:"scroll of confusion",x:e,y:a}):(0,r.createItem)({name:"scroll of map",x:e,y:a}),o&&(s.game.actors.push(o),s.game.sendToBack(o))}dig(e,t,a,i,s){if(e=(0,c.float2int)(e),a=(0,c.float2int)(a),t=(0,c.float2int)(t),a<e){const t=a;a=e,e=t}if((i=(0,c.float2int)(i))<t){const e=i;i=t,t=e}let r=!1;for(let o=e;o<=a;o++)for(let n=t;n<=i;n++){const l=o+n*this.width;0!=this.tiles[l].canWalk||!0!==r||e!==a&&t!==i||s&&o!==this.stairsX&&n!==this.stairsY&&this.templateDoors.push(new u.default(o,n,0,0)),r=this.tiles[l].canWalk,this.tiles[l].canWalk=!0}}addActors(e){let a=t.random.getInt(0,this.MAX_ROOM_MONSTERS),i=t.random.getInt(0,this.MAX_ROOM_ITEMS);const s=e.x,r=e.x+e.w,o=e.y,n=e.y+e.h;for(;a>0;){const e=t.random.getInt(s,r),i=t.random.getInt(o,n);this.canWalk(e,i)&&this.addMonster(e,i),a--}for(;i>0;){const e=t.random.getInt(s,r),a=t.random.getInt(o,n);this.canWalk(e,a)&&this.additem(e,a),i--}}createRoom(e,t,a,i,s){this.dig(e,t,a,i,s)}generate(e,a,i){this.levelSeed=a,this.depth=i,t.random.setSeed(this.levelSeed+25*i);const s=t.random.getInt(4,8);console.log("seed: "+this.levelSeed),console.log("depth: "+this.depth),console.log("split level:"+s),this.ambienceColor=d.Colors.AMBIENCE_COLOR[t.random.getInt(0,d.Colors.AMBIENCE_COLOR.length)];const r=new o.default(0,0,this.width,this.height,s);this.tiles=new Array(this.width*this.height).fill(!1);const n=[],l=t.random.getInt(0,100)>70?1:2;for(let e=0;e<this.width*this.height;e++)this.tiles[e]=new f;let h=0,g=0,m=0,p=0,_=0,v=0;const y=t.random.getInt(0,r.rooms.length-1),w=t.random.getInt(0,r.rooms.length-1);for(let a=0;a<r.rooms.length;a++){const i=r.rooms[a],s=a===y;1===l&&(_=i.w,v=i.h,m=i.x+1,p=i.y+1,this.createRoom(m,p,m+_-2,p+v-2,e),s||n.push(new u.default(m,p,_-2,v-2))),2===l&&(_=t.random.getInt(this.ROOM_MIN_SIZE,i.w-2),v=t.random.getInt(this.ROOM_MIN_SIZE,i.h-2),m=t.random.getInt(i.x,i.x+i.w-_-0)+1,p=t.random.getInt(i.y,i.y+i.h-v-0)+1,this.createRoom(m,p,m+_-2,p+v-2,e),s||n.push(new u.default(m,p,_-2,v-2))),a===y&&(this.startX=m+(0,c.float2int)(_/2),this.startY=p+(0,c.float2int)(v/2)),a===w&&(this.stairsX=(0,c.float2int)(m+_/2),this.stairsY=(0,c.float2int)(p+v/2)),1!==l&&2!==l||(a>0&&(this.dig(h,g,m+_/2,g,e),this.dig(m+_/2,g,m+_/2,p+v/2,e)),h=m+_/2,g=p+v/2)}if(e){for(const e of n)this.addActors(e);for(const e of this.templateDoors)this.addDoor(e.x,e.y,!0)}}render(){var e,t;for(let a=0;a<this.height;a++)for(let i=0;i<this.width;i++){const r=null===(t=null===(e=s.game.player)||void 0===e?void 0:e.fov)||void 0===t?void 0:t.getMapped(i,a),o=i+s.game.camera.x,n=a+s.game.camera.y;2!==r&&1!==r||(2===r?s.game.drawChar(this.isWall(i,a)?"#":".",o,n,d.Colors.WALL):s.game.drawChar(this.isWall(i,a)?"#":".",o,n,d.Colors.WALL_DARK))}}}},557:(e,t)=>{var a;Object.defineProperty(t,"__esModule",{value:!0}),t.Abilities=t.ABILITIES=void 0,function(e){e[e.STR=0]="STR",e[e.DEX=1]="DEX",e[e.CON=2]="CON",e[e.INT=3]="INT",e[e.WIS=4]="WIS"}(a=t.ABILITIES||(t.ABILITIES={})),t.Abilities=class{constructor(e,t,a,i,s){this.str=0,this.dex=0,this.con=0,this.int=0,this.wis=0,this.str=e,this.dex=t,this.con=a,this.int=i,this.wis=s}getBonus(e){let t=0;switch(e){case a.STR:t=this.str;break;case a.DEX:t=this.dex;break;case a.CON:t=this.con;break;case a.INT:t=this.int;break;case a.WIS:t=this.wis}return Math.floor((t-10)/2)}getBonusWithSign(e){const t=this.getBonus(e);return(t>=0?"+":"")+t.toString()}inRange(e){return e>0&&e<=18}}},889:(e,t)=>{var a;Object.defineProperty(t,"__esModule",{value:!0}),t.ArmorType=void 0,(a=t.ArmorType||(t.ArmorType={}))[a.LIGHT_ARMOR=0]="LIGHT_ARMOR",a[a.MEDIUM_ARMOR=1]="MEDIUM_ARMOR",a[a.HEAVY_ARMOR=2]="HEAVY_ARMOR",a[a.SHIELD=3]="SHIELD",t.default=class{constructor(e){this.name=e.name,this.armorClass=e.ac,this.armorClassAbilityType=e.armorClassAbilityType,this.armorType=e.armorType,this.armorRequirementStrenght=null==e?void 0:e.requirementStrenght}}},529:function(e,t,a){var i=this&&this.__awaiter||function(e,t,a,i){return new(a||(a=Promise))((function(s,r){function o(e){try{l(i.next(e))}catch(e){r(e)}}function n(e){try{l(i.throw(e))}catch(e){r(e)}}function l(e){var t;e.done?s(e.value):(t=e.value,t instanceof a?t:new a((function(e){e(t)}))).then(o,n)}l((i=i.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0});const s=a(607),r=a(557),o=a(692),n=a(792),l=a(928),c=a(409);t.default=class{constructor(e,t){this.power_melee=e,this.power_range=t,this.rangeAttack_range=0}attack(e,t){return i(this,void 0,void 0,(function*(){this.meleeAttack(e,t)}))}attackPhase(e,t,a,i,r){var d;if(t.destructible&&!t.destructible.isDead()){const h=n.random.dice(1,20,0),u=(0,l.ensure)(e.abilities).getBonus(a);let f=!1;if(1===h)return void s.game.log.add(`${t.name} miss attack by ${e.name}`);if(20===h&&(f=!0,s.game.log.add(`${e.name} makes critical attack to ${t.name}!`,c.Colors.HILIGHT_TEXT)),h>=t.destructible.defense){const[a,h]=i.split("d");let g=1;const m=n.random.dice(g=!0===f?2*parseInt(a):parseInt(a),parseInt(h),0),p=h;s.game.log.add(`${e.name} attacks ${t.name} for ${m} hit points (${g}d${p}${u>0?"+":"-"}${Math.abs(u)}).`,e===s.game.player?c.Colors.PLAYER_ATTACK:c.Colors.ENEMY_ATTACK);let _=m+u;if(_<0&&(_=0),t.destructible.takeDamage(t,_),r===o.DamageType.BLUDGEONING&&!0===f){const a=e.getDistance(t.x,t.y),i=(0,l.float2int)((t.x-e.x)/a),r=(0,l.float2int)((t.y-e.y)/a);(null===(d=s.game.map)||void 0===d?void 0:d.canWalk(t.x+i,t.y+r))&&(t.x+=i,t.y+=r)}}else s.game.log.add(`${t.name} miss attack by ${e.name}`)}}rangeAttack(e,t,a){var o,n,d,h,u;return i(this,void 0,void 0,(function*(){const i=s.game.getActor(t,a),f=(0,l.float2int)(e.getDistance(t,a)),g=(t-e.x)/f,m=(a-e.y)/f;let p=e.x,_=e.y,v="-";Math.abs(g)<Math.abs(m)&&(v="|");for(let e=0;e<f+1;e++)yield(0,l.sleep)(100),p+=g,_+=m,s.game.render(),s.game.drawChar(v,(0,l.float2int)(p)+s.game.camera.x,(0,l.float2int)(_)+s.game.camera.y,c.Colors.HILIGHT_TEXT);s.game.render();const y=null===(d=null===(n=null===(o=e.equipments)||void 0===o?void 0:o.getRangeWeapon())||void 0===n?void 0:n.weapon)||void 0===d?void 0:d.damageType;i&&(null===(u=null===(h=s.game.player)||void 0===h?void 0:h.fov)||void 0===u?void 0:u.isInFov(t,a))&&this.attackPhase(e,i,r.ABILITIES.DEX,this.power_range,y)}))}meleeAttack(e,t){var a,i,s;if(t.destructible&&!t.destructible.isDead()){const n=null===(s=null===(i=null===(a=e.equipments)||void 0===a?void 0:a.getMeleeWeapon())||void 0===i?void 0:i.weapon)||void 0===s?void 0:s.damageType;this.attackPhase(e,t,r.ABILITIES.STR,this.power_melee,void 0===n?o.DamageType.BLUDGEONING:n)}}}},637:function(e,t,a){var i=this&&this.__awaiter||function(e,t,a,i){return new(a||(a=Promise))((function(s,r){function o(e){try{l(i.next(e))}catch(e){r(e)}}function n(e){try{l(i.throw(e))}catch(e){r(e)}}function l(e){var t;e.done?s(e.value):(t=e.value,t instanceof a?t:new a((function(e){e(t)}))).then(o,n)}l((i=i.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.prepareNewJourney=void 0;const s=a(607),r=a(557),o=a(887),n=a(935),l=a(928),c=a(409);var d;!function(e){e[e.choose_race=0]="choose_race",e[e.choose_class=1]="choose_class",e[e.choose_abilities=2]="choose_abilities",e[e.phases_max=3]="phases_max"}(d||(d={})),t.prepareNewJourney=()=>i(void 0,void 0,void 0,(function*(){var e,t,a,i,h,u,f;let g,m=d.choose_race,p=0,_=0,v=0,y=0,w=14,T=0,b=0,x=0;const E=(0,n.createListOfRaces)(),A=(0,o.createListOfClasses)(),I=new r.Abilities(10,10,10,10,10),S=new r.Abilities(10,10,10,10,10),C=(e,t,a)=>{s.game.clear(),s.game.renderVersion(),s.game.drawText("New game",10,1,c.Colors.HILIGHT_TEXT);for(let e=0;e<3;e++){const t=m===e?c.Colors.HILIGHT_TEXT:c.Colors.DEFAULT_TEXT;0==e&&s.game.drawText("Choose race",10,10,t),1==e&&s.game.drawText("Choose class",20,10,t),2==e&&s.game.drawText("Set abilities",30,10,t)}s.game.drawText("Enter) Next   Backspace) Back   Use arrow keys to navigate",11,s.game.height,c.Colors.DEFAULT_TEXT),s.game.drawChar(">",8,12+p,c.Colors.DEFAULT_TEXT);for(let e=0;e<E.length;e++)s.game.drawText(E[e],10,12+e);s.game.drawChar(">",18,12+_,c.Colors.DEFAULT_TEXT);for(let e=0;e<A.length;e++)s.game.drawText(A[e],20,12+e);s.game.drawText(x>0?`hp increase: ${x} per level`:"",10,18,c.Colors.DEFAULT_TEXT),s.game.drawText("none"!==e?`Resiliences: ${e}`:"",10,19,c.Colors.DEFAULT_TEXT),m===d.choose_abilities&&(g=[],g.push("Use left and right arrows to change ability scores."),g.push(""),0===v&&g.push("Strength: Measuring physical power."),1===v&&g.push("Dexterity: Measuring agility."),2===v&&g.push("Constitution: Measuring endurance."),3===v&&g.push("Intelligence: Measuring reasoning and memory."),4===v&&g.push("Wisdom: Measuring perception and insight.")),s.game.drawChar(">",28,12+v,c.Colors.DEFAULT_TEXT),s.game.drawText("Strength",30,12),s.game.drawText("Dexterity",30,13),s.game.drawText("Constitution",30,14),s.game.drawText("Intelligence",30,15),s.game.drawText("Wisdom",30,16),s.game.drawText("Unused points",30,17),s.game.drawText(`${I.str}`,37,12),s.game.drawText(`${I.dex}`,37,13),s.game.drawText(`${I.con}`,37,14),s.game.drawText(`${I.int}`,37,15),s.game.drawText(`${I.wis}`,37,16),s.game.drawText(`${w}`,37,17),s.game.drawText(0!==a.str?`+${a.str.toString()}`:"",39,12),s.game.drawText(0!==a.dex?`+${a.dex.toString()}`:"",39,13),s.game.drawText(0!==a.con?`+${a.con.toString()}`:"",39,14),s.game.drawText(0!==a.int?`+${a.int.toString()}`:"",39,15),s.game.drawText(0!==a.wis?`+${a.wis.toString()}`:"",39,16),s.game.drawText(`= ${S.str.toString()} (${S.getBonusWithSign(r.ABILITIES.STR)})`,41,12),s.game.drawText(`= ${S.dex.toString()} (${S.getBonusWithSign(r.ABILITIES.DEX)})`,41,13),s.game.drawText(`= ${S.con.toString()} (${S.getBonusWithSign(r.ABILITIES.CON)})`,41,14),s.game.drawText(`= ${S.int.toString()} (${S.getBonusWithSign(r.ABILITIES.INT)})`,41,15),s.game.drawText(`= ${S.wis.toString()} (${S.getBonusWithSign(r.ABILITIES.WIS)})`,41,16);for(let e=0;e<g.length;e++)s.game.drawText(g[e],10,21+e,c.Colors.DEFAULT_TEXT);if(s.game.drawText("Profiencies: ",55,20),t.length>0)for(let e=0;e<t.length;e++)s.game.drawText(t[e],55,22+e);const i=S.getBonus(r.ABILITIES.CON),o=T+i,n=b+i;s.game.drawText(`Health at start: ${T} + ${i} (CON) = ${o}`,50,12),s.game.drawText(`Health increase per level +${b} + ${i} (CON) = ${n}`,50,13)},k=e=>{w-e>=0&&(0===v&&(I.inRange(I.str+e)?I.str+=e:e=0),1===v&&(I.inRange(I.dex+e)?I.dex+=e:e=0),2===v&&(I.inRange(I.con+e)?I.con+=e:e=0),3===v&&(I.inRange(I.int+e)?I.int+=e:e=0),4===v&&(I.inRange(I.wis+e)?I.wis+=e:e=0),w-=e)};for(;;){x=(0,l.ensure)(null===(e=(0,n.getRace)(E[p]))||void 0===e?void 0:e.toughnessIncrease);const r=(0,l.ensure)(null===(t=(0,n.getRace)(E[p]))||void 0===t?void 0:t.resilience),c=(0,l.createListOfProficiencies)(E[p],A[_]);if(m===d.choose_race){const e=(0,l.ensure)(null===(a=(0,n.getRace)(E[p]))||void 0===a?void 0:a.flavourText);g=(0,l.ensure)((0,l.wordWrap)(e,48))}else if(m===d.choose_class){const e=(0,l.ensure)(null===(i=(0,o.getClass)(A[_]))||void 0===i?void 0:i.flavourText);g=(0,l.ensure)((0,l.wordWrap)(e,48))}const w=(0,l.ensure)(null===(h=(0,n.getRace)(E[p]))||void 0===h?void 0:h.abilityIncrease);S.str=I.str+w.str,S.dex=I.dex+w.dex,S.con=I.con+w.con,S.int=I.int+w.int,S.wis=I.wis+w.wis,C(r,c,w),T=(0,l.ensure)(null===(u=(0,o.getClass)(A[_]))||void 0===u?void 0:u.healthAtStart),b=(0,l.ensure)(null===(f=(0,o.getClass)(A[_]))||void 0===f?void 0:f.healthIncreasePerLevel),y=0;let O=!1;switch(yield s.game.getch()){default:break;case"Enter":m++,m>=d.phases_max&&(O=!0);break;case"Backspace":m--,m<0&&(m=0);break;case"ArrowUp":y=-1;break;case"ArrowDown":y=1;break;case"ArrowLeft":m===d.choose_abilities&&k(-1);break;case"ArrowRight":m===d.choose_abilities&&k(1)}if(O)break;m===d.choose_race&&(p+=y,p<0&&(p=E.length-1),p>E.length-1&&(p=0)),m===d.choose_class&&(_+=y,_<0&&(_=A.length-1),_>A.length-1&&(_=0)),m===d.choose_abilities&&(v+=y,v<0&&(v=4),v>4&&(v=0))}return[S,p,_,T,b,x]}))},887:function(e,t,a){var i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.getClassNameByIndex=t.createListOfProficiencies_byClass=t.createListOfClasses=t.getClass=void 0;const s=i(a(373)),r=a(928),o=s.default,n=e=>o.find((t=>t.name===e));t.getClass=e=>{if((e=>{for(const t of o)if(t.name===e)return!0;return!1})(e))return(0,r.ensure)(n(e))},t.createListOfClasses=()=>{const e=[];for(const t of s.default)e.push(t.name);return e},t.createListOfProficiencies_byClass=e=>{const t=(0,r.ensure)(n(e)),a=[];for(const e of t.proficiencies)a.push(e.type);return a},t.getClassNameByIndex=e=>o[e].name},127:function(e,t,a){var i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.createMonster=t.monsters=void 0;const s=i(a(260)),r=i(a(47)),o=a(557),n=i(a(529)),l=i(a(808)),c=a(792),d=a(107),h=a(928);t.monsters=r.default,t.createMonster=(e,a,i)=>{let r="1d4",u=0,f=1,g=0,m="?",p=s.default.default_monster,_=new o.Abilities(2,2,2,2,2);if((e=>{for(const a of t.monsters)if(a.name===e)return!0;return!1})(e)){const a=(0,h.ensure)((e=>t.monsters.find((t=>t.name===e)))(e));m=a.ch,p=a.color,r=a.attacks[0].damage,g=a.ac,f=a.hp,u=a.xp,_=new o.Abilities(a.abilities.str,a.abilities.dex,a.abilities.con,a.abilities.int,a.abilities.wis)}const v=new l.default(a,i,m,e,p);return v.destructible=new d.MonsterDestructible(f,g,`dead ${e}`,u),v.attacker=new n.default(r,"1d1"),v.ai=new c.MonsterAI,v.abilities=_,v}},935:function(e,t,a){var i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.getRaceNameByIndex=t.createListOfProficiencies_byRace=t.createListOfRaces=t.getRace=void 0;const s=i(a(882)),r=a(928),o=s.default,n=e=>o.find((t=>t.name===e));t.getRace=e=>{if((e=>{for(const t of o)if(t.name===e)return!0;return!1})(e))return(0,r.ensure)(n(e))},t.createListOfRaces=()=>{const e=[];for(const t of s.default)e.push(t.name);return e},t.createListOfProficiencies_byRace=e=>{const t=(0,r.ensure)(n(e)),a=[];for(const e of t.proficiencies)a.push(e.type);return a},t.getRaceNameByIndex=e=>o[e].name},190:function(e,t,a){var i=this&&this.__awaiter||function(e,t,a,i){return new(a||(a=Promise))((function(s,r){function o(e){try{l(i.next(e))}catch(e){r(e)}}function n(e){try{l(i.throw(e))}catch(e){r(e)}}function l(e){var t;e.done?s(e.value):(t=e.value,t instanceof a?t:new a((function(e){e(t)}))).then(o,n)}l((i=i.apply(e,t||[])).next())}))},s=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.createSpell=t.getSpell=t.spells=void 0;const r=s(a(686)),o=a(607),n=a(557),l=a(792),c=a(928),d=a(409);t.spells=r.default,t.getSpell=e=>{if((e=>!!t.spells.find((t=>t.name===e)))(e)){const a=(0,c.ensure)((e=>t.spells.find((t=>t.name===e)))(e));return a}console.log(`There is no spell called ${e}`)},t.createSpell=(e,t,a)=>i(void 0,void 0,void 0,(function*(){var i,s,r,h,u,f,g,m,p,_,v,y,w,T,b,x;console.log("caster",t),console.log(`spell level: ${a}`),console.log(JSON.stringify(e,null,2));const E=e.amount.split(";"),A=e.effectValues.split(";"),I=parseInt(E[a-1]),S=A[a-1];for(let a=0;a<I;a++){let a;if(e.range>0){const[i,s,r]=yield o.game.pickATile(t.x,t.y,e.range);i&&(a=o.game.getActor(s,r))}else a=t;if(a){const E=e.effectType.split(";");for(const A of E){console.log(`effect: ${A}`),console.log(`effect value: ${S}`);const[E,I,C]=l.random.parseDice(S);let k=0;e.effectValue_mod.length>0&&("str"===e.effectValue_mod&&(k=(0,c.ensure)(null===(i=t.abilities)||void 0===i?void 0:i.getBonus(n.ABILITIES.STR))),"dex"===e.effectValue_mod&&(k=(0,c.ensure)(null===(s=t.abilities)||void 0===s?void 0:s.getBonus(n.ABILITIES.DEX))),"con"===e.effectValue_mod&&(k=(0,c.ensure)(null===(r=t.abilities)||void 0===r?void 0:r.getBonus(n.ABILITIES.CON))),"int"===e.effectValue_mod&&(k=(0,c.ensure)(null===(h=t.abilities)||void 0===h?void 0:h.getBonus(n.ABILITIES.INT))),"win"===e.effectValue_mod&&(k=(0,c.ensure)(null===(u=t.abilities)||void 0===u?void 0:u.getBonus(n.ABILITIES.WIS))));let O=!1,R=0;"str"===e.target_saving_throw_type&&(R=(0,c.ensure)(null===(f=a.abilities)||void 0===f?void 0:f.getBonus(n.ABILITIES.STR))),"dex"===e.target_saving_throw_type&&(R=(0,c.ensure)(null===(g=a.abilities)||void 0===g?void 0:g.getBonus(n.ABILITIES.DEX))),"con"===e.target_saving_throw_type&&(R=(0,c.ensure)(null===(m=a.abilities)||void 0===m?void 0:m.getBonus(n.ABILITIES.CON))),"int"===e.target_saving_throw_type&&(R=(0,c.ensure)(null===(p=a.abilities)||void 0===p?void 0:p.getBonus(n.ABILITIES.INT))),"wis"===e.target_saving_throw_type&&(R=(0,c.ensure)(null===(_=a.abilities)||void 0===_?void 0:_.getBonus(n.ABILITIES.WIS)));const N=l.random.dice(1,20,R),D=l.random.dice(1,20,null===(v=t.abilities)||void 0===v?void 0:v.getBonus(n.ABILITIES.INT));""!==e.target_saving_throw_type&&(o.game.log.add(`Attack roll ${D} (1d20 ${null===(y=t.abilities)||void 0===y?void 0:y.getBonusWithSign(n.ABILITIES.INT)}) against ${N} (${e.target_saving_throw_type} 1d20 ${R>0?"+"+R:R})`),N>=D&&(O=!0));const M=l.random.dice(E,I,C)+k,L=k>0?`+${k}`:`${k}`,P=S+(e.effectValue_mod.length>0?` with ${e.effectValue_mod.toUpperCase()} ${L}`:"");"heal"===A?(o.game.log.add(`${t.name} cast a ${e.name} and heals for ${M} hit points (${P}).`),null===(w=a.destructible)||void 0===w||w.heal(M)):"force"===A||"acid"===A||"lightning"===A?""!==e.target_saving_throw_type?!0===O&&"half_damage"===e.if_target_saving_throw_success?(o.game.log.add(`${t.name} cast a ${e.name} to ${a.name} for ${(0,c.float2int)(M/2)} hit points (${P} / 2).`),null===(T=a.destructible)||void 0===T||T.takeDamage(a,(0,c.float2int)(M/2))):(o.game.log.add(`${t.name} cast a ${e.name} to ${a.name} for ${(0,c.float2int)(M)} hit points (${P}).`),null===(b=a.destructible)||void 0===b||b.takeDamage(a,(0,c.float2int)(M))):(o.game.log.add(`${t.name} cast a ${e.name} to ${a.name} for ${M} hit points (${P}).`),null===(x=a.destructible)||void 0===x||x.takeDamage(a,M)):o.game.log.add(`unkow effect type ${A}`,d.Colors.DISALLOWED)}}}}))},692:(e,t)=>{var a;Object.defineProperty(t,"__esModule",{value:!0}),t.DamageType=void 0,(a=t.DamageType||(t.DamageType={}))[a.BLUDGEONING=0]="BLUDGEONING",a[a.PIERCING=1]="PIERCING",a[a.SLASHING=2]="SLASHING",t.default=class{constructor(e){this.name=e.name,this.damage=e.damage,this.damageType=e.damageType,this.rangeMax=e.rangeMax,this.needReload=e.needReload,this.isReloaded=!1}}},808:function(e,t,a){var i=this&&this.__createBinding||(Object.create?function(e,t,a,i){void 0===i&&(i=a),Object.defineProperty(e,i,{enumerable:!0,get:function(){return t[a]}})}:function(e,t,a,i){void 0===i&&(i=a),e[i]=t[a]}),s=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),r=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var a in e)"default"!==a&&Object.prototype.hasOwnProperty.call(e,a)&&i(t,e,a);return s(t,e),t},o=this&&this.__awaiter||function(e,t,a,i){return new(a||(a=Promise))((function(s,r){function o(e){try{l(i.next(e))}catch(e){r(e)}}function n(e){try{l(i.throw(e))}catch(e){r(e)}}function l(e){var t;e.done?s(e.value):(t=e.value,t instanceof a?t:new a((function(e){e(t)}))).then(o,n)}l((i=i.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0});const n=a(607),l=r(a(524)),c=a(887),d=a(935),h=a(792),u=a(928);t.default=class{constructor(e,t,a,i,s){this.fovOnly=!0,this.blocks=!0,this.x=(0,u.float2int)(e),this.y=(0,u.float2int)(t),this.ch=a,this.color=s,this.name=i,this.race=0,this.class=0}create(e){var t,a,i,s,r,o;let n;this.blocks=!1,"Wearable"===(null===(t=e.pickable)||void 0===t?void 0:t.effectName)&&(n=new l.Wearable(e.pickable.effect.type)),"AiChangeEffect"===(null===(a=e.pickable)||void 0===a?void 0:a.effectName)&&(n=new l.AiChangeEffect(new h.ConfusedMonsterAi(parseInt(e.pickable.effect.newAi.nbTurns)),e.pickable.effect.message)),"HealthEffect"===(null===(i=null==e?void 0:e.pickable)||void 0===i?void 0:i.effectName)&&(n=new l.HealthEffect(null===(s=e.pickable)||void 0===s?void 0:s.effect.amount,void 0)),(null===(r=null==e?void 0:e.pickable)||void 0===r?void 0:r.selectorName)?this.pickable=new l.default({selector:new l.TargetSelector((0,u.ensure)(e.pickable.selector).type,(0,u.ensure)(e.pickable.selector).range),effect:n,weight:e.pickable.weight}):this.pickable=new l.default({selector:void 0,effect:n,weight:(0,u.ensure)(null===(o=e.pickable)||void 0===o?void 0:o.weight)})}render(){var e,t;const a=null===(t=null===(e=n.game.player)||void 0===e?void 0:e.fov)||void 0===t?void 0:t.getMapped(this.x,this.y);(2===a||0!=a&&!this.fovOnly)&&n.game.drawChar(this.ch,this.x+n.game.camera.x,this.y+n.game.camera.y,this.color)}update(){return o(this,void 0,void 0,(function*(){this.ai&&(yield this.ai.update(this))}))}computeFov(){this.fov&&this.fov.compute(this.x,this.y,10)}getDistance(e,t){const a=this.x-e,i=this.y-t;return Math.sqrt(a*a+i*i)}getProfiencies(){const e=(0,d.createListOfRaces)(),t=(0,c.createListOfClasses)();this.proficiencies=(0,u.createListOfProficiencies)(e[this.race],t[this.class])}}},792:function(e,t,a){var i=this&&this.__awaiter||function(e,t,a,i){return new(a||(a=Promise))((function(s,r){function o(e){try{l(i.next(e))}catch(e){r(e)}}function n(e){try{l(i.throw(e))}catch(e){r(e)}}function l(e){var t;e.done?s(e.value):(t=e.value,t instanceof a?t:new a((function(e){e(t)}))).then(o,n)}l((i=i.apply(e,t||[])).next())}))},s=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.ConfusedMonsterAi=t.TemporaryAI=t.ConfusedAI=t.MonsterAI=t.PlayerAI=t.random=void 0;const r=a(607),o=a(190),n=a(928),l=a(409),c=s(a(451));t.random=new c.default;class d{}t.default=d,t.PlayerAI=class extends d{constructor(){super(),this.xpLevel=1}getNextLevelXP(){return 200+150*this.xpLevel}pickDirection(){return i(this,void 0,void 0,(function*(){const e=yield r.game.getch();let t=0,a=0;return"ArrowLeft"===e&&(t=-1),"ArrowRight"===e&&(t=1),"ArrowUp"===e&&(a=-1),"ArrowDown"===e&&(a=1),[t,a]}))}update(e){var t,a,s;return i(this,void 0,void 0,(function*(){const i=this.getNextLevelXP();if((0,n.ensure)(e.destructible).xp>=i&&(this.xpLevel++,(0,n.ensure)(e.destructible).xp-=i,r.game.log.add(`Your battle skills grow stronger! You reached level ${this.xpLevel}`,l.Colors.LEVEL_UP),r.game.render()),e.destructible&&e.destructible.isDead())return;let o=0,c=0;const d=yield r.game.getch();switch(d){case"ArrowLeft":o--;break;case"ArrowRight":o++;break;case"ArrowUp":c--;break;case"ArrowDown":c++;break;default:yield this.handleActionKey(e,d)}0===o&&0===c||(r.game.gameStatus=r.GameStatus.NEW_TURN,(yield this.moveOrAttack(e,e.x+o,e.y+c))&&(null===(t=r.game.player)||void 0===t||t.computeFov(),r.game.camera.compute((0,n.ensure)(null===(a=r.game.player)||void 0===a?void 0:a.x),(0,n.ensure)(null===(s=r.game.player)||void 0===s?void 0:s.y))))}))}handleActionKey(e,t){return i(this,void 0,void 0,(function*(){const a=()=>i(this,void 0,void 0,(function*(){var t,a;r.game.log.add("Which direction?"),r.game.render();const[i,s]=yield this.pickDirection();(null===(t=null===r.game||void 0===r.game?void 0:r.game.map)||void 0===t?void 0:t.openCloseDoor(e.x+i,e.y+s))||r.game.log.add("There is no any door."),null===(a=r.game.player)||void 0===a||a.computeFov(),r.game.gameStatus=r.GameStatus.NEW_TURN})),s=()=>i(this,void 0,void 0,(function*(){r.game.save(),r.game.log.add("Game saved...",l.Colors.GAME_SAVED)})),c=()=>i(this,void 0,void 0,(function*(){r.game.log.add("Use item");const t=yield this.choseFromInventory(e);t?(yield(0,n.ensure)(t.pickable).use(t,e),r.game.gameStatus=r.GameStatus.NEW_TURN):r.game.log.add("Nevermind...")})),d=()=>i(this,void 0,void 0,(function*(){const t=yield this.choseFromInventory(e);t?(yield(0,n.ensure)(t.pickable).drop(t,e),r.game.gameStatus=r.GameStatus.NEW_TURN):r.game.log.add("Nevermind...")})),h=()=>i(this,void 0,void 0,(function*(){const t=yield this.choseFromInventory(e);t?(yield(0,n.ensure)(t.pickable).wear(t,e),r.game.gameStatus=r.GameStatus.NEW_TURN):r.game.log.add("Nevermind...")})),u=()=>i(this,void 0,void 0,(function*(){var t,a,i,s;if(r.game.getClosestMonster(e.x,e.y,2))return void r.game.log.add("Can't shoot. You are in melee fight.");const o=null===(t=e.equipments)||void 0===t?void 0:t.getRangeWeapon();if(o){if((null===(a=o.weapon)||void 0===a?void 0:a.needReload)&&!o.weapon.isReloaded)return o.weapon.isReloaded=!0,r.game.log.add(`Reloading ${o.name}...`),void(r.game.gameStatus=r.GameStatus.NEW_TURN);const[t,l,c]=yield r.game.pickATile(e.x,e.y,null===(i=o.weapon)||void 0===i?void 0:i.rangeMax);(0,n.ensure)(o.weapon).isReloaded=!1,t&&(yield null===(s=e.attacker)||void 0===s?void 0:s.rangeAttack(e,l,c),r.game.gameStatus=r.GameStatus.NEW_TURN)}else r.game.log.add("Can't shoot. You need ranged weapon first.")})),f=()=>i(this,void 0,void 0,(function*(){r.game.renderMenuBackground({title:"HELP",x:15,y:4,w:45,h:30}),r.game.drawText("Use ARROW KEYS to move and attacks",17,6,l.Colors.DEFAULT_TEXT),r.game.drawText("a: Shoot",17,7,l.Colors.DEFAULT_TEXT),r.game.drawText("s: Spell",17,8,l.Colors.DEFAULT_TEXT),r.game.drawText("g: Pick up a item.",17,9,l.Colors.DEFAULT_TEXT),r.game.drawText("i: Use item",17,10,l.Colors.DEFAULT_TEXT),r.game.drawText("d: Drop item from inventory",17,11,l.Colors.DEFAULT_TEXT),r.game.drawText(">: Use stairs",17,12,l.Colors.DEFAULT_TEXT),r.game.drawText("o: Open or close door.",17,13,l.Colors.DEFAULT_TEXT),r.game.drawText("w: Wear/equip",17,14,l.Colors.DEFAULT_TEXT),r.game.drawText("P/p: Pull/push",17,15,l.Colors.DEFAULT_TEXT),yield r.game.getch()})),g=()=>i(this,void 0,void 0,(function*(){var t,a,i,s;r.game.log.add("Which direction to push?"),r.game.render();const[o,l]=yield this.pickDirection();(null===(t=null===r.game||void 0===r.game?void 0:r.game.map)||void 0===t?void 0:t.pushTo(e.x+o,e.y+l,o,l))||r.game.log.add("There's nothing to push."),null===(a=r.game.player)||void 0===a||a.computeFov(),r.game.camera.compute((0,n.ensure)(null===(i=r.game.player)||void 0===i?void 0:i.x),(0,n.ensure)(null===(s=r.game.player)||void 0===s?void 0:s.y)),r.game.gameStatus=r.GameStatus.NEW_TURN})),m=()=>i(this,void 0,void 0,(function*(){var t,a,i,s;r.game.log.add("Which direction to pull?"),r.game.render();const[o,l]=yield this.pickDirection();(null===(t=null===r.game||void 0===r.game?void 0:r.game.map)||void 0===t?void 0:t.pullTo(e.x,e.y,o,l))?(e.x+=o,e.y+=l):r.game.log.add("There's nothing to pull."),null===(a=r.game.player)||void 0===a||a.computeFov(),r.game.camera.compute((0,n.ensure)(null===(i=r.game.player)||void 0===i?void 0:i.x),(0,n.ensure)(null===(s=r.game.player)||void 0===s?void 0:s.y)),r.game.gameStatus=r.GameStatus.NEW_TURN})),p=()=>i(this,void 0,void 0,(function*(){const t=["acid splash","cure wounds","magic missile","ruaah","lightning"];r.game.renderMenuBackground({title:"test spells",x:20,y:4,w:20,h:4+t.length});let a="a";for(let e=0;e<t.length;e++)r.game.drawText(`${a}) ${t[e]}`,22,6+e,l.Colors.DEFAULT_TEXT),a=String.fromCharCode(a.charCodeAt(0)+1);const i=(yield r.game.getch()).charCodeAt(0)-97;if(i<0||i>=t.length)r.game.log.add("Nevermind");else{r.game.log.add(`Selected spell: ${t[i]}`);const a=(0,o.getSpell)(t[i]);a&&(yield(0,o.createSpell)(a,e,1))}}));switch(t){case"S":s();break;case">":(null===(_=r.game.stairs)||void 0===_?void 0:_.x)===e.x&&(null===(v=r.game.stairs)||void 0===v?void 0:v.y)===e.y?r.game.nextLevel():r.game.log.add("There are no stairs here.");break;case"g":(()=>{r.game.gameStatus=r.GameStatus.NEW_TURN;let t=!1;for(const a of r.game.actors)if(a.pickable&&a.x===e.x&&a.y===e.y){if(a.pickable.pick(a,e)){t=!0,r.game.log.add(`You pick up the ${a.name}`,l.Colors.PICKED_UP);break}t||(t=!0,r.game.log.add("Your inventory is full.",l.Colors.INVENTORY_FULL))}t||r.game.log.add("There's nothing here that you can pick up.")})();break;case"i":yield c();break;case"d":yield d();break;case"o":yield a();break;case"w":yield h();break;case"a":yield u();break;case"?":yield f();break;case"p":yield g();break;case"P":yield m();break;case"s":yield p()}var _,v}))}moveOrAttack(e,t,a){var s;return i(this,void 0,void 0,(function*(){if(null===(s=r.game.map)||void 0===s?void 0:s.isWall(t,a))return!1;let i=!1;for(const i of r.game.actors)if(i.destructible&&!i.destructible.isDead()&&i.x===t&&i.y===a)return yield(0,n.ensure)(e.attacker).attack(e,i),!1;for(const e of r.game.actors)(e.destructible&&e.destructible.isDead||e.pickable||"door"===e.name&&"D"===e.ch)&&e.x===t&&e.y===a&&r.game.log.add(`There is a ${e.name} here`),"door"===e.name&&e.blocks&&e.x===t&&e.y===a&&(i=!0);return!i&&(e.x=t,e.y=a,!0)}))}choseFromInventory(e){return i(this,void 0,void 0,(function*(){r.game.clear(),r.game.render(),e.container&&e.container.render();const t=(yield r.game.getch()).charCodeAt(0)-97;return t>=0&&t<(0,n.ensure)(e.container).inventory.length?(0,n.ensure)(e.container).inventory[t]:null}))}},t.MonsterAI=class extends d{constructor(){super(),this.TRACKING_TURNS=3,this.moveCount=0}update(e){var t,a;return i(this,void 0,void 0,(function*(){const i=r.game.player;e.destructible&&e.destructible.isDead()||!i||((null===(a=null===(t=r.game.player)||void 0===t?void 0:t.fov)||void 0===a?void 0:a.isInFov(e.x,e.y))?this.moveCount=this.TRACKING_TURNS:this.moveCount--,this.moveCount>0&&this.moveOrAttack(e,i.x,i.y))}))}moveOrAttack(e,t,a){var i,s,o,l;let c=t-e.x,d=a-e.y;const h=c>0?1:-1,u=d>0?1:-1,f=Math.sqrt(c*c+d*d);f>=2?(c=Math.round(c/f),d=Math.round(d/f),(null===(i=r.game.map)||void 0===i?void 0:i.canWalk(e.x+c,e.y+d))?(e.x+=(0,n.float2int)(c),e.y+=(0,n.float2int)(d)):(null===(s=r.game.map)||void 0===s?void 0:s.canWalk(e.x+h,e.y))?e.x+=(0,n.float2int)(h):(null===(o=r.game.map)||void 0===o?void 0:o.canWalk(e.x,e.y+u))&&(e.y+=(0,n.float2int)(u))):null===(l=null==e?void 0:e.attacker)||void 0===l||l.attack(e,(0,n.ensure)(r.game.player))}},t.ConfusedAI=class extends d{constructor(e,t){super(),this.nbTurns=e,this.oldAi=t}update(e){var a,s;return i(this,void 0,void 0,(function*(){const i=t.random.getInt(-1,1),o=t.random.getInt(-1,1);if(0!==i||0!==o){const t=e.x+i,n=e.y+o;if(null===(a=r.game.map)||void 0===a?void 0:a.canWalk(t,n))e.x=t,e.y=n;else{const a=r.game.getActor(t,n);a&&(null===(s=null==e?void 0:e.attacker)||void 0===s||s.attack(e,a))}}this.nbTurns--,this.nbTurns<=0&&(e.ai=this.oldAi)}))}};class h extends d{constructor(e){super(),this.nbTurns=e}update(e){return i(this,void 0,void 0,(function*(){this.nbTurns--,0===this.nbTurns&&(e.ai=this.oldAi)}))}applyTo(e){this.oldAi=e.ai,e.ai=this}}t.TemporaryAI=h,t.ConfusedMonsterAi=class extends h{constructor(e){super(e)}update(e){const a=Object.create(null,{update:{get:()=>super.update}});var s,o;return i(this,void 0,void 0,(function*(){const i=t.random.getInt(-1,1),n=t.random.getInt(-1,1);if(0!=i||0!=n){const t=e.x+i,a=e.y+n;if(null===(s=r.game.map)||void 0===s?void 0:s.canWalk(t,a))e.x=t,e.y=a;else{const i=r.game.getActor(t,a);i&&(null===(o=null==e?void 0:e.attacker)||void 0===o||o.attack(e,i))}}a.update.call(this,e)}))}}},107:(e,t,a)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.PlayerDestructible=t.MonsterDestructible=void 0;const i=a(607),s=a(928),r=a(409);class o{constructor(e,t,a,i,s){this.maxHP=e,this.hp=this.maxHP,this.defense=t,this.corpseName=a,this.type=i,this.xp=s,this.hpPerLevel=0,this.hpPerLevelBonuses=0}isDead(){return this.hp<=0}heal(e){return this.hp+=e,this.hp>this.maxHP&&(e-=this.hp-this.maxHP,this.hp=this.maxHP),e}takeDamage(e,t){return this.hp-=t,this.hp<=0&&this.die(e),t}die(e){e.color=r.Colors.DEAD_BODY,e.name=this.corpseName,e.blocks=!1,i.game.sendToBack(e)}}t.default=o,t.MonsterDestructible=class extends o{constructor(e,t,a,i){super(e,t,a,"monster",i),this.xp=i}die(e){var t;i.game.log.add(`${e.name} is dead. You gain ${this.xp} xp`),(0,s.ensure)(null===(t=i.game.player)||void 0===t?void 0:t.destructible).xp+=this.xp,super.die(e)}},t.PlayerDestructible=class extends o{constructor(e,t,a){super(e,t,a,"player",0)}die(e){i.game.log.add("You died",r.Colors.DEFEAT),super.die(e),i.game.gameStatus=i.GameStatus.DEFEAT}}},409:function(e,t,a){var i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.Colors=void 0;const s=i(a(260));t.Colors={BACKGROUND:s.default.ui_map_background,WALL:s.default.ui_wall,WALL_DARK:s.default.ui_wall_dark,DOOR:s.default.ui_door,HEALTHPOTION:s.default.pickup_healthpotion,NUTELLABUN:s.default.pickup_nutellabun,SCROLL_OF_LIGHTING:s.default.pickup_scroll_of_lightning,SCROLL_OF_FIREBALL:s.default.pickup_scroll_of_fireball,SCROLL_OF_CONFUSION:s.default.pickup_scroll_of_confusion,SCROLL_OF_MAP:s.default.pickup_scroll_of_map,ARMOR_ITEM:s.default.pickup_armor_item,WEAPON_ITEM:s.default.pickup_weapon_item,LEVEL_UP:s.default.ui_level_up,HEALED:s.default.ui_healed,MENU_CURSOR:s.default.ui_menu_cursor,GAME_SAVED:s.default.ui_game_saved,PICKED_UP:s.default.ui_picked_up,INVENTORY_FULL:s.default.ui_inventory_full,MENU_BORDER:s.default.ui_menu_border,ALLOWED:s.default.ui_allowed,DISALLOWED:s.default.ui_disallowed,HP_10_PERCENT:s.default.ui_hp_10_percent,HP_25_PERCENT:s.default.ui_hp_25_percent,HP_50_PERCENT:s.default.ui_hp_50_percent,HP_95_PERCENT:s.default.ui_hp_95_percent,HP_MAX:s.default.ui_hp_max,HERO:s.default.actor_hero,STAIRS:s.default.actor_stairs,PLAYER_ATTACK:s.default.log_player_attack,ENEMY_ATTACK:s.default.log_enemy_attack,DEAD_BODY:s.default.log_dead_body,DEFAULT_TEXT:s.default.log_default_text,HILIGHT_TEXT:s.default.log_hilight_text,DEFEAT:s.default.log_defeat,AMBIENCE_COLOR:["#0088FF","#CCAAFF","#000000","#CCCCCC","#33AA33","#AAFFAA","#CC00CC","#FFFF00","#33AACC","#FF0000"],VERSION:s.default.ui_version}},928:(e,t,a)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.capitalize=t.sleep=t.createListOfProficiencies=t.wordWrap=t.dimmerColor=t.rgbToHex=t.hexToRGB=t.ensure=t.float2int=t.debugInit=t.printVersionContainer=t.populateVersion=t.paddedLogObject=void 0;const i=a(887),s=a(935);t.paddedLogObject=e=>{const t=Object.keys(e).reduce(((e,t)=>t.length+3>e?t.length+3:e),0);console.log(Object.keys(e).map((a=>`${a.padEnd(t," ")}: ${e[a]}`)).join("\n"))},t.populateVersion=()=>"Commit ID: <span>88af8d8</span> | Version: <span>v0.0.1.15a</span>",t.printVersionContainer=()=>{(0,t.ensure)(document.querySelector("#version")).innerHTML=(0,t.populateVersion)()},t.debugInit=()=>{(0,t.paddedLogObject)({BUILD_DATE:"2021-11-13",BUILD_TIME:"11:31:27",BUILD_DATETIME:"2021-11-13T11:31:27.296Z",COMMIT_HASH:"88af8d8",VERSION:"v0.0.1.15a"})},t.float2int=e=>e>>0,t.ensure=(e,t="This value was promised to be there.")=>{if(null==e)throw new TypeError(t);return e},t.hexToRGB=e=>{let t=0,a=0,i=0;return 4==e.length?(t=parseInt(`0x${e[1]}${e[1]}`,16),a=parseInt(`0x${e[2]}${e[2]}`,16),i=parseInt(`0x${e[3]}${e[3]}`,16)):7==e.length&&(t=parseInt(`0x${e[1]}${e[2]}`,16),a=parseInt(`0x${e[3]}${e[4]}`,16),i=parseInt(`0x${e[5]}${e[6]}`,16)),[t,a,i]},t.rgbToHex=(e,t,a)=>"#"+((1<<24)+(e<<16)+(t<<8)+a).toString(16).slice(1),t.dimmerColor=(e,a)=>{let[i,s,r]=(0,t.hexToRGB)(e);return i*=a,s*=a,r*=a,i<0&&(i=0),s<0&&(s=0),r<0&&(r=0),i>255&&(i=255),s>255&&(s=255),r>255&&(r=255),i=(0,t.float2int)(i),s=(0,t.float2int)(s),r=(0,t.float2int)(r),(0,t.rgbToHex)(i,s,r)},t.wordWrap=(e,t)=>{let a=0;const i=[];let s=0,r=0;for(let o=0;o<e.length;o++)" "===e.charAt(o)&&(a=o),s++,s>=t&&(i.push(e.substring(r,a)),s=0,r=a+1);return i.push(e.substring(r,e.length)),i},t.createListOfProficiencies=(e,t)=>{const a=(0,s.createListOfProficiencies_byRace)(e),r=(0,i.createListOfProficiencies_byClass)(t),o=new Set,n=[];for(const e of a)o.add(e);for(const e of r)o.add(e);for(const e of o)n.push(e);return n},t.sleep=e=>new Promise((t=>setTimeout(t,e))),t.capitalize=e=>e.charAt(0).toUpperCase()+e.slice(1)},5:(e,t,a)=>{Object.defineProperty(t,"__esModule",{value:!0});const i=a(607),s=a(928),r=a(409);class o{constructor(e,t){this.text=e,this.color=t}}t.default=class{constructor(){this.SIZE_OF_LOG=100,this.texts=[]}render(){let e=0,t=this.texts.length;t>10&&(t=10);for(let a=this.texts.length-16;a<this.texts.length;a++)a>=0&&(i.game.drawText(this.texts[a].text,1,i.game.height+3+e,(0,s.dimmerColor)(this.texts[a].color,.05*(20-t))),e++,t--)}add(e,t=r.Colors.DEFAULT_TEXT){this.texts.push(new o((0,s.capitalize)(e),t)),this.texts.length>this.SIZE_OF_LOG&&this.texts.splice(0,1)}}},865:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.Menu=t.MenuItemCode=t.MenuItem=void 0;class a{constructor(){this.code=0,this.label=""}}var i;t.MenuItem=a,(i=t.MenuItemCode||(t.MenuItemCode={}))[i.NONE=0]="NONE",i[i.NEW_GAME=1]="NEW_GAME",i[i.CONTINUE=2]="CONTINUE",i[i.EXIT=3]="EXIT",i[i.CONSTITUTION=4]="CONSTITUTION",i[i.STRENGTH=5]="STRENGTH",i[i.AGILITY=6]="AGILITY",t.Menu=class{constructor(){this.items=[]}clear(){this.items&&this.items.length>0&&(this.items=[])}addItem(e,t){const i=new a;i.code=e,i.label=t,this.items.push(i)}}},451:(e,t,a)=>{Object.defineProperty(t,"__esModule",{value:!0});const i=a(928);let s=0;t.default=class{constructor(){this.rnd=0}setSeed(e){s=e}calc(){s=(9301*s+49297)%233280,this.rnd=s/233280}getInt(e,t){return t=t||1,e=e||0,this.calc(),Math.floor(e+this.rnd*(t-e))}dice(e,t,a=0){let i=0;t++;for(let a=0;a<e;a++)i+=Number(this.getInt(1,t));return i+=+a,i<e&&(i=e),i}parseDice(e){const t=e.includes("+")?parseInt((0,i.ensure)(e.split("+").at(1))):0,[a,s]=e.split("d");return[parseInt(a),parseInt(s),t]}}},357:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.default=class{constructor(e,t,a,i){this.x=e,this.y=t,this.w=a,this.h=i}GetHalfDimensionX(){return this.w/2}GetHalfDimensionY(){return this.h/2}GetCenterX(){return this.x+this.GetHalfDimensionX()}GetCenterY(){return this.y+this.GetHalfDimensionY()}}}},t={};function a(i){var s=t[i];if(void 0!==s)return s.exports;var r=t[i]={exports:{}};return e[i].call(r.exports,r,r.exports,a),r.exports}a.d=(e,t)=>{for(var i in t)a.o(t,i)&&!a.o(e,i)&&Object.defineProperty(e,i,{enumerable:!0,get:t[i]})},a.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),a.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},a(607)})();